"use strict";(self._cf=self._cf||[]).push([[1823],{161461:(e,t,a)=>{a.d(t,{M:()=>i});const i=a(331377).ZP`fragment UserPermissionFragment on Query{user(current:true){id confluence{permissionType}}}`},275281:(e,t,a)=>{a.d(t,{F:()=>i});const i=e=>{var t,a;return null==e||null===(t=e.user)||void 0===t||null===(a=t.confluence)||void 0===a?void 0:a.permissionType}},515137:(e,t,a)=>{a.d(t,{o:()=>n,K:()=>r});var i=a(331377);const n=i.ZP`query GetOnboardingState($key:[String]){onboardingState(key:$key){key value}}`,r=i.ZP`mutation SetOnboardingState($key:String$value:String)@experimental{experimentalSetOnboardingState(key:$key value:$value){key value}}`},555543:(e,t,a)=>{a.d(t,{c:()=>i});const i={PERSISTENT_UPGRADE_EXPERIMENT:"confluence.frontend.growth.experiments.persistent.upgrade",ONBOARDING_EXP_FLAG:"confluence.frontend.onboarding.experience",ADMIN_QUICKSTART_V2:"confluence.frontend.onboarding.admin-quickstart-v2",MIGRATIONS_QUICKSTART:"confluence.frontend.onboarding.migrations.quickstart",CACHE_ONBOADING_STATE:"confluence.frontend.onboarding.cache.state",INVITE_DOMAIN_ACCESS:"confluence.frontend.onboarding-invite-domain-access",SWITCHER_JOINABLE_PRODUCTS_FF:"confluence.frontend.enable.joinable-products",NTH_USER_QUICKSTART:"confluence.frontend.onboarding.nth.user.quickstart",JSW_XFLOW_USER_QUICKSTART:"confluence.frontend.onboarding.xflow.jsw",EDITOR_ONBOARDING_USER_TAGGING:"confluence.frontend.onboarding.editor-onboarding.user-tagging",EASY_MENTIONS_PLACEHOLDER_FEATURE_FLAG:"confluence.frontend.easy.mentions.placeholder",MIGRATIONS_USER_TAGGING:"confluence.frontend.onboarding.migrations.user-tagging",MIGRATIONS_SITE_TRAITS:"confluence.frontend.onboarding.migrations.site-traits",IMPORT_RELEVANCE:"confluence.frontend.onboarding.import-relevance"}},722721:(e,t,a)=>{a.d(t,{$x:()=>i,QL:()=>r,gA:()=>o,hY:()=>s,OJ:()=>c,th:()=>l,Ou:()=>d,Gf:()=>u,$g:()=>E,Iv:()=>g,dA:()=>p,Wp:()=>T,VR:()=>S,SY:()=>_,LE:()=>f,zo:()=>b,w:()=>I,Vg:()=>m,r8:()=>k,n$:()=>v,Fj:()=>A,hb:()=>O,z1:()=>N,$J:()=>R,Gd:()=>C,vT:()=>D,RG:()=>y,gD:()=>L,pv:()=>h});const i={IS_PANEL_OPEN:"quickstart-state:isPanelOpen",IS_DISMISSED:"quickstart-state:isDismissed",OPEN_TASK_ID:"quickstart-state:openTaskId",OPEN_COMPONENT_ID:"quickstart-state:openComponentId",JSW_CONFLUENCE_INTRO_TASK:"quickstart-state:jswConfIntroCompleted",HELP_COMPLETED:"quickstart-state:helpCompleted",SPACE_MODAL_COMPLETED:"quickstart-state:spaceModalCompleted",SPACE_TOUR_COMPLETED:"quickstart-state:spaceTourCompleted",COLLABORATE_COMPLETED:"quickstart-state:collaborateCompleted",HOME_MODAL_COMPLETED:"quickstart-state:homeModalCompleted",HOME_TOUR_COMPLETED:"quickstart-state:homeTourCompleted",MOBILE_COMPLETED:"quickstart-state:mobileCompleted",HAS_SEEN_DISMISSED_FLAG:"quickstart-state:hasSeenDismissedFlag",IS_MIGRATED_USER_V2:"quickstart-state:isMigratedUserV2",JSW_XFLOW_SWITCHER_TOUR_TASK:"quickstart-state:jswXflowSwitcherTourCompleted",ORIGIN_ATTRIBUTES:"onboarding-origin-state:attributes",JSW_CONFLUENCE_MODAL:"quickstart-state:jswXFlowModalCompleted",EDITOR_TUTORIAL_TASK_COMPLETED:"quickstart-state:editorTutorialTaskCompleted",QSV2_READ_GUIDE_COMPLETED:"quickstart-state:qsv2ReadConfluenceGuideCompleted",QSV2_INVITE_TEAMMATE_TASK:"quickstart-state:qsv2InviteTeammateCompleted",QSV2_INTEGRATION_TASK:"quickstart-state:qsv2IntegrationCompleted",QSV2_VIDEO_TOUR_COMPLETED:"quickstart-state:qsv2SiteVideoTourCompleted",QSV2_SPOTLIGHT_COMPLETED:"quickstart-state:qsv2SpotlightCompleted",MIGRATIONS_WELCOME_TASK:"quickstart-state:migrationsWelcomeCompleted",MIGRATIONS_NEW_PAGE_TASK:"quickstart-state:migrationsNewPageCompleted",MIGRATIONS_COLLABORATE_TASK:"quickstart-state:migrationsCollaborateCompleted",MIGRATIONS_FIND_AND_ORGANIZE_PAGES_COMPLETED:"quickstart-state:migrationsFindAndOrganizePagesCompleted",MIGRATIONS_EDIT_AND_CUSTOMIZE_CONTENT_TASK:"quickstart-state:migrationsEditAndCustomizeContentCompleted",SIMPLIFY_ADMIN_RENAME_TASK:"quickstart-state:simplifyAdminRenameSiteCompleted",NQSV2_HELP_TASK_COMPLETED:"quickstart-state:nqsv2HelpCompleted",NQSV2_CREATE_TASK_COMPLETED:"quickstart-state:nqsv2CreateCompleted",NQSV2_COLLABORATE_TASK_COMPLETED:"quickstart-state:nqsv2CollaborateCompleted",NQSV2_CONFLUENCE_101_TASK:"quickstart-state:nqsv2Confluence101Completed"},n="quickstart-checklist.invite-teammate",r="quickstart-checklist.integration",o="quickstart-checklist.help",s="quickstart-checklist.space-tour",c="quickstart-checklist.find-home",l="quickstart-checklist.collaborate",d="quickstart-checklist.mobile",u="quickstart-checklist.jsw-xflow-switcher-tour",E="quickstart-checklist.jsw-conf-intro",g="quickstart-checklist.jswXFlowModalCompleted",p="SHOW_SWITCHER_SPOTLIGHT_ONLY",T="quickstart-checklist.invite-teammate-v2",S="quickstart-checklist.confluence-guide-v2",_="quickstart-checklist.integration-v2",f="quickstart-checklist.site-tour-v2",b="quickstart-checklist.close-spotlight",I="quickstart-checklist.migrations.welcome",m="quickstart-checklist.migrations.new-page",k="quickstart-checklist.migrations.collaborate",v="quickstart-checklist.migrations.find-and-organize-pages",A="quickstart-checklist.migrations.edit-and-customize-content",O="quickstart-checklist.simplify.admin.rename-site",N="quickstart-checklist.nth-user-v2.help",R="quickstart-checklist.nth-user-v2.confluence-101",C="quickstart-checklist.nth-user-v2.create",D="quickstart-checklist.nth-user-v2.collaborate",y={[n]:"inviteTeammateCompleted",[r]:"integrationCompleted",[o]:"helpCompleted",[s]:"spaceTourCompleted",[c]:"homeTourCompleted",[l]:"collaborateCompleted",[d]:"mobileCompleted",[u]:"jswXflowSwitcherTourCompleted",[E]:"jswConfIntroCompleted",[g]:"jswXFlowModalCompleted",[S]:"qsv2ReadConfluenceGuideCompleted",[T]:"qsv2InviteTeammateCompleted",[_]:"qsv2IntegrationCompleted",[f]:"qsv2SiteVideoTourCompleted",[b]:"qsv2SpotlightCompleted",[I]:"migrationsWelcomeCompleted",[m]:"migrationsNewPageCompleted",[k]:"migrationsCollaborateCompleted",[v]:"migrationsFindAndOrganizePagesCompleted",[A]:"migrationsEditAndCustomizeContentCompleted",[O]:"simplifyAdminRenameSiteCompleted",[C]:"nqsv2CreateCompleted",[D]:"nqsv2CollaborateCompleted",[N]:"nqsv2HelpCompleted",[R]:"nqsv2Confluence101Completed"},L=new Set([s,c,l,n,E,S,T,_,f,I,m,k,A,v,O,D,R]),h={ONBOARDING_ATTRIBUTES_UPDATED:"onboardingAttributesUpdated",CACHE_UPDATE_FAILED:"cacheUpdateFailed"}},485226:(e,t,a)=>{a.d(t,{C:()=>r});var i=a(555543);const{ONBOARDING_EXP_FLAG:n}=i.c,r=(e,t=!0)=>e.getBooleanValue(n,{default:!1,shouldTrackExposureEvent:t})},634837:(e,t,a)=>{a.d(t,{$:()=>l});var i=a(499082),n=a(158466),r=a(902195),o=a(213489);const s=a(331377).ZP`query SitePersonalizationQuery($cloudId:String!)@experimental{experimentalSitePersonalization(cloudId:$cloudId){attributes{name value}}}`;let c=!1;const l=({cloudId:e,skip:t,fetchPolicy:a})=>{var l;const{isLoggedIn:d,isLicensed:u}=(0,n.D)(),E=t||!d||!u||c,{data:g,loading:p,error:T}=(0,i.aM)(s,{variables:{cloudId:e},fetchPolicy:a||"cache-first",skip:E,onError(e){var t;c=null==e||null===(t=e.graphQLErrors)||void 0===t?void 0:t.some((e=>{var t,a,i;return(null==e||null===(t=e.path)||void 0===t?void 0:t.includes("experimentalSitePersonalization"))&&((null==e||null===(a=e.message)||void 0===a?void 0:a.includes("/personalization Received status 401"))||(null==e||null===(i=e.message)||void 0===i?void 0:i.includes("/personalization Received status 403"))||(0,r.j)(e,"401")||(0,o.T)(e))}))}});return{loading:p,error:T,attributes:(null==g||null===(l=g.experimentalSitePersonalization)||void 0===l?void 0:l.attributes)||[]}}},206638:(e,t,a)=>{a.d(t,{Hi:()=>c,Gs:()=>l,Si:()=>d,B8:()=>u,wA:()=>E});var i=a(331377),n=a(499082),r=a(401487),o=a(158466),s=a(515137);const c=e=>{const t={},{onboardingState:a}=e||{};return void 0!==a&&a.forEach((({key:e,value:a})=>{const i=e.split(":")[1];a&&(/(true|false)/g.test(a)?t[i]="true"===a:t[i]=a)})),t},l=()=>{const[e,{error:t}]=(0,n.Db)(s.K,{update(e,{data:t}){const a=t.experimentalSetOnboardingState,{key:n,value:r}=a;e.writeFragment({id:n,fragment:i.ZP`fragment myKey on OnboardingState{key value}`,data:{key:n,value:r,__typename:"OnboardingState"}})},onError:e=>{"unauthorized"===e.graphQLErrors[0].message&&(0,r.Xb)(e)}});return{setOnboardingState:({key:t,value:a})=>e({variables:{key:t,value:a},optimisticResponse:{experimentalSetOnboardingState:{key:t,value:a,__typename:"OnboardingState"}}}),error:t}},d=(e,t=!1)=>{const{isLoggedIn:a,isLicensed:i}=(0,o.D)(),r=t||(!a||!i),{data:c,error:l,loading:d,refetch:u}=(0,n.aM)(s.o,{variables:{key:e},skip:r});return{data:c,error:l,loading:d,refetch:u}},u=async(e,t)=>await e.query({query:s.o,variables:{key:t}}),E=async(e,{key:t,value:a})=>await e.mutate({mutation:s.K,variables:{key:t,value:a},update(e){e.writeFragment({id:t,fragment:i.ZP`fragment myKey on OnboardingState{key value}`,data:{key:t,value:a,__typename:"OnboardingState"}})}})},546575:(e,t,a)=>{a.d(t,{z:()=>O});var i=a(991332),n=a(122551),r=a(621070),o=a(158466),s=a(634837),c=a(485226),l=a(148330),d=a(555543);const u=(e,t=!1)=>e.getBooleanValue(d.c.MIGRATIONS_SITE_TRAITS,{default:!1,shouldTrackExposureEvent:t});var E=a(722721);var g=a(206638);const{MIGRATION_STATUS_ELIGIBLE:p,EXTENDED_TRIAL_ELIGIBLE:T,MIGRATED_SITE_INELIGIBLE:S,MIGRATED_SITE_ENDED:_,MIGRATION_STATUS_PERIOD_ELIGIBLE:f,EXTENDED_TRIAL_PERIOD_ELIGIBLE:b,MIGRATION_STATUS_PERIOD_ENDED:I,MIGRATION_STATUS_PERIOD_INELIGIBLE:m,EXTENDED_TRIAL_PERIOD_ENDED:k,EXTENDED_TRIAL_PERIOD_INELIGIBLE:v,ADDED_MIGRATED_USER_TAG:A}={MIGRATED_SITE_INELIGIBLE:"migratedSiteIneligible",MIGRATED_SITE_ENDED:"migratedSiteEnded",MIGRATION_STATUS_ELIGIBLE:"migrationStatusEligible",EXTENDED_TRIAL_ELIGIBLE:"extendedTrialEligible",MIGRATION_STATUS_PERIOD_ELIGIBLE:"migrationStatusPeriodEligible",EXTENDED_TRIAL_PERIOD_ELIGIBLE:"extendedTrialPeriodEligible",MIGRATION_STATUS_PERIOD_ENDED:"migrationStatusPeriodEnded",MIGRATION_STATUS_PERIOD_INELIGIBLE:"migrationStatusPeriodIneligible",EXTENDED_TRIAL_PERIOD_ENDED:"extendedTrialPeriodEnded",EXTENDED_TRIAL_PERIOD_INELIGIBLE:"extendedTrialPeriodIneligible",ADDED_MIGRATED_USER_TAG:"addedMigratedUserTag"},O=()=>{var e,t;const{isLicensed:a,isLoggedIn:O,featureFlagClient:N,locale:R,cloudId:C}=(0,o.D)(),{createAnalyticsEvent:D}=(0,r._)(),{setOnboardingState:y}=(0,g.Gs)(),L=(0,c.C)(N),h=((e,t,a=!1)=>!!(0,l.RV)(t)&&e.getBooleanValue(d.c.MIGRATIONS_USER_TAGGING,{default:!1,shouldTrackExposureEvent:a}))(N,R),M=u(N),U=(e,t)=>{D({type:"sendTrackEvent",data:{source:"useMigratedUser",actionSubject:"isMigratedUser",action:e,attributes:t}}).fire()};let P=!1;const{data:q,loading:G}=(0,g.Si)(Object.values(E.$x),!h||!O||!a),Q=E.$x.IS_MIGRATED_USER_V2,w=(null==q||null===(e=q.onboardingState)||void 0===e||null===(t=e.find((e=>e.key===Q)))||void 0===t?void 0:t.value)||void 0,x=void 0===w,V=!h||!L||!("true"===w||x)||G,{loading:F,error:B,attributes:j}=(0,s.$)({cloudId:C,skip:V}),X=null==j?void 0:j.reduce(((e,t)=>(0,i.Z)((0,i.Z)({},e),{},{[t.name]:t.value})),{}),H=null==X?void 0:X.confluence_entitlement_type,K=null==X?void 0:X["confluence.ondemand.activationDate"],$=null==X?void 0:X.confluence_migration_status;if((0,n.useEffect)((()=>{!G&&x&&u(N,!0)}),[G,x,N]),G||F||V||B||!h&&!M)return{isMigratedUser:!1,isMigratedUserReady:!0,error:B,isMigratedUserTaggingFF:h,isMigrationsSiteTraitsEnabledFF:M,skipQuery:V};const z=null==X?void 0:X.confluence_first_migration_signal_date,W={confluenceMigrationStatus:$,confluenceFirstMigrationSignalDate:z,confluenceFirstMigrationPurchaseDate:null==X?void 0:X.confluence_first_migration_purchase_date,confluenceMigrationTouchpoint:null==X?void 0:X.confluence_migration_touchpoint,confluenceMigrationType:null==X?void 0:X.confluence_migration_type},J="true"===$,Z=J?z:K;if(!(J||"EXTENDED_TRIAL"===H)){if(void 0!==$||"true"===w){U("true"===w?_:S,(0,i.Z)({entitlementType:H},W)),"false"!==w&&y({key:Q,value:"false"})}return{isMigratedUser:P,isMigratedUserReady:!F&&!B,error:B,isMigratedUserTaggingFF:h,isMigrationsSiteTraitsEnabledFF:M,skipQuery:V}}if(x){U(J?p:T,(0,i.Z)({isMigratedTraitActive:J,entitlementType:H},W))}if(Z){const e=(0,l.iJ)(Z,l.IP.ADD,3),t=new Date<e;if(!t){return U(((e,t)=>{let a=I;return t&&e?a=I:t&&!e?a=m:!t&&e?a=k:t||e||(a=v),a})("true"===w,J),{migrationsStartDate:Z,migrationsExpiryDate:e,isMigratedUser:P}),"false"!==w&&y({key:Q,value:"false"}),{isMigratedUser:P,isMigratedUserReady:!F&&!B,error:B,isMigratedUserTaggingFF:h,isMigrationsSiteTraitsEnabledFF:M,skipQuery:V}}if(x){U(J?f:b,{migrationsStartDate:Z,migrationsExpiryDate:e,migrationPeriodEligible:t})}P=!0,"true"!==w&&(y({key:Q,value:"true"}),U(A,{isMigratedUser:P}))}return{isMigratedUser:!(F||B||V)&&P,isMigratedUserReady:!F&&!B,error:B,isMigratedUserTaggingFF:h,isMigrationsSiteTraitsEnabledFF:M,skipQuery:V}}},732657:(e,t,a)=>{let i;a.d(t,{HX:()=>i,q3:()=>n}),function(e){e.ENROLLED="enrolled",e.NOT_ENROLLED="not-enrolled",e.CONTROL="control",e.EXPERIMENT="experiment"}(i||(i={}));const n=(e,t,a)=>e.getVariantValue(t,{default:i.NOT_ENROLLED,oneOf:[i.EXPERIMENT,i.NOT_ENROLLED,i.CONTROL,i.ENROLLED],shouldTrackExposureEvent:a});Object.keys(i).map((e=>i[e]))},148330:(e,t,a)=>{a.d(t,{RV:()=>i,IP:()=>n,iJ:()=>r});const i=e=>{let t=!0,a=!0;return e&&(t=-1!==e.toLowerCase().indexOf("en",0)),navigator&&(a=navigator.language.includes("en")),a&&t};let n;!function(e){e.ADD="ADD",e.SUBTRACT="SUBTRACT"}(n||(n={}));const r=(e,t,a)=>{const i=new Date(e),n=i;let r=i.getMonth();const o=i.getDate();return"ADD"===t?r+=a:"SUBTRACT"===t&&(r-=a),n.setMonth(r),o!=n.getDate()&&n.setDate(0),n}},673009:(e,t,a)=>{let i;a.d(t,{H:()=>i}),function(e){e.ENROLLED="enrolled",e.NOT_ENROLLED="not-enrolled",e.CONTROL="control",e.EXPERIMENT="experiment",e.EXPERIMENT_VARIATION_1="experiment-1",e.EXPERIMENT_VARIATION_2="experiment-2"}(i||(i={}))},77243:(e,t,a)=>{a.d(t,{G:()=>i});const i={MIGRATIONS_QUICKSTART:"confluence.frontend.onboarding.migrations.quickstart",ONBOARDING_STATE_REFACTOR:"confluence.frontend.onboarding.onboarding-state-refactor",SIMPLIFY_ADMIN_SETUP:"confluence.frontend.onboarding.simplify.admin.setup",REMOVE_ROLE_SCREEN:"confluence.frontend.onboarding.remove.role.screen",NTH_USER_QUICKSTART_V2:"confluence.frontend.onboarding.nth-user-quickstart-v2",ACCOUNT_SETUP_MODAL:"confluence.frontend.onboarding.account-setup-modal",REMOVE_SINGLE_SPACE_SELECTION:"confluence.frontend.onboarding.skip-single-space-selection",PERSISTENT_INVITE:"confluence.frontend.onboarding.persistent-invite",PERSISTENT_INVITE_CALIBRATION:"confluence.frontend.onboarding.persistent-invite.calibration",REVAMP_INVITE_MODAL:"confluence.frontend.onboarding.revamp-invite-modal",IMPORT_RELEVANCE:"confluence.frontend.onboarding.import-relevance",SKIP_SPACE_NAMING:"confluence.frontend.onboarding.skip-space-naming",UPDATE_PERSONAL_SPACE_CREATION:"confluence.frontend.onboarding.update.personal.space.creation",CONTEXTUAL_INVITE_PROMPT:"confluence.frontend.onboarding.contextual-invite-prompt",HOME_AS_LANDING_PAGE:"confluence.frontend.onboarding.home-as-landing-page",INTENT_QUESTIONS_GATING:"confluence.frontend.onboarding.intent-questions.gating",INTENT_QUESTIONS_GATING_CALIBRATION:"confluence.frontend.onboarding.intent-questions.gating.calibration",INTENT_QUESTIONS_VARIATION:"confluence.frontend.onboarding.intent-questions.variation",INTENT_QUESTIONS_VARIATION_CALIBRATION:"confluence.frontend.onboarding.intent-questions.variation.calibration"}},435083:(e,t,a)=>{a.d(t,{g:()=>o});var i=a(673009),n=a(197250),r=a(77243);const o=(e,t,a=!0)=>{const o=(0,n.q)(e,r.G.ONBOARDING_STATE_REFACTOR,Boolean(a));return o===i.H.ENROLLED||o===i.H.EXPERIMENT&&/^en/i.test(t)}},707967:(e,t,a)=>{a.d(t,{y:()=>r});var i=a(122551),n=a(405665);const r=()=>{const{isSiteAdmin:e,loading:t,error:a}=(0,i.useContext)(n.wu);return{isSiteAdmin:e&&!t&&!a}}},197250:(e,t,a)=>{a.d(t,{q:()=>n});var i=a(673009);const n=(e,t,a)=>e.getVariantValue(t,{default:i.H.NOT_ENROLLED,oneOf:Object.values(i.H),shouldTrackExposureEvent:a})},764708:(e,t,a)=>{a.d(t,{R:()=>i});const i=e=>{let t=!0,a=!0;return e&&(t=-1!==e.toLowerCase().indexOf("en",0)),navigator&&(a=navigator.language.includes("en")),a&&t}},771458:(e,t,a)=>{a.d(t,{QQ:()=>u,lm:()=>E,QF:()=>g});var i=a(991332),n=a(122551),r=a(621070),o=a(451379),s=a(199319),c=a(772443),l=a(201823);const d=(e,t,a,i,n)=>e?"migrationsQuickstart":n?"nthUserQuickstartV2":a?"xflowAdminUserQuickstart":i?"xflowNthUserQuickstart":t?"nthUserQuickstart":"adminQuickstart",u=()=>{const e=(0,n.useContext)(o.F),{isNthUserQSEligible:t,isNthUserQSV2Eligible:a,isMigrationsQuickstartEligible:i,isJswXflowUserQSEligible:r,isAdmin:c}=(0,l.d)(),u=d(i(),t(),c&&r(),!c&&r(),a());return{experienceTracker:e,startOnboardingQuickstart:()=>{e.start({name:s.apt,attributes:{quickstartType:u}})},failOnboardingQuickstart:t=>{e.fail({name:s.apt,error:t||new Error("Experience Tracker: Onboarding Quickstart Failed"),attributes:{quickstartType:u}})},finishOnboardingQuickstart:()=>{e.succeed({name:s.apt,attributes:{quickstartType:u}})}}},E=()=>{const{createAnalyticsEvent:e}=(0,r._)(),{isNthUserQSEligible:t,isMigrationsQuickstartEligible:a,isJswXflowUserQSEligible:o,isAdmin:s,isNthUserQSV2Eligible:u,isStateRefactorEnabled:E}=(0,l.d)(),g=d(a(),t(),s&&o(),!s&&o(),u()),p=(0,n.useCallback)(((t,a)=>{e({type:"sendTrackEvent",data:{action:"ineligible",actionSubject:"quickstart",source:t,attributes:{inEligibleReasons:a,quickstartType:g}}}).fire()}),[e,g]),T=(0,n.useCallback)((t=>{e({data:{attributes:(0,i.Z)({namespaces:c.up,quickstartType:g},t),name:c.up},type:"sendScreenEvent"}).fire()}),[e,g]),S=(0,n.useCallback)((t=>{e({type:"sendUIEvent",data:{source:c.up,actionSubject:"button",action:t?"opened":"closed",actionSubjectId:c.nU,attributes:{namespaces:c.up,quickstartType:g}}}).fire()}),[e,g]),_=(0,n.useCallback)((t=>{e({type:"sendScreenEvent",data:{attributes:{products:t},name:"exploreIntegrationsQuickstartDrawer"}}).fire()}),[e]),f=(0,n.useCallback)((t=>{e({type:"sendScreenEvent",data:{attributes:{products:t},name:"adminQSV2ExploreIntegrationsQuickstartDrawer"}}).fire()}),[e]),b=(0,n.useCallback)((()=>{e({type:"sendScreenEvent",data:{attributes:{quickstartType:g},name:c.VU}}).fire()}),[e,g]),I=(0,n.useCallback)(((t,a)=>{e({type:"sendOperationalEvent",data:{source:t,action:"added",actionSubject:"onboardingQuickstartCard",actionSubjectId:a,attributes:{quickstartType:g}}}).fire()}),[e,g]),m=(0,n.useCallback)((()=>{e({type:"sendUIEvent",data:{source:c.VU,actionSubject:"button",action:"clicked",actionSubjectId:c.Ux,attributes:{namespaces:`navigationNextScreen.${c.VU}`,quickstartType:g}}}).fire()}),[e,g]),k=(0,n.useCallback)(((t,a,i,n)=>{e({type:"sendUIEvent",data:{source:c.up,actionSubject:"checklistItem",action:t?"opened":"closed",actionSubjectId:n,attributes:{taskPosition:a,taskId:i,namespaces:c.up,quickstartType:g}}}).fire()}),[e,g]),v=(0,n.useCallback)(((t,a,i)=>{const n={namespaces:c.up,quickstartType:g};t&&(n.completedTasks=a,n.totalTasks=i),e({type:"sendUIEvent",data:{source:c.up,actionSubject:"button",action:t?"dismissed":"reactivated",actionSubjectId:c.nU,attributes:n}}).fire()}),[e,g]);return{firePanelViewed:T,firePanelToggled:S,fireExploreIntegrationsExpanded:_,fireAdminQSV2ExploreIntegrationsExpanded:f,fireButtonViewed:b,fireCardAdded:I,fireButtonClicked:m,fireTaskToggled:k,fireQuickstartError:(0,n.useCallback)(((t,a,i)=>{e({type:"sendOperationalEvent",data:{source:t,action:"failed",actionSubject:"onboardingQuickstart",actionSubjectId:a,attributes:{message:JSON.stringify(i),quickstartType:g}}}).fire()}),[e,g]),fireDismissToggled:v,fireCtaClicked:(0,n.useCallback)((t=>{e({type:"sendUIEvent",data:{source:t,action:"clicked",actionSubject:"button",actionSubjectId:c.KI,attributes:{namespaces:c.up,quickstartType:g}}}).fire()}),[e,g]),fireCarouselActionEvent:(0,n.useCallback)(((t,a,i,n)=>{e({type:"sendUIEvent",data:{action:t,actionSubject:"carousel",actionSubjectId:c.zc,source:i,attributes:{taskId:a,index:n,quickstartType:g}}}).fire()}),[e,g]),fireVideoEvent:(0,n.useCallback)(((t,a,i,n)=>{e({type:"sendTrackEvent",data:{action:t,actionSubject:a,source:i,attributes:{namespaces:c.up,videoProgress:n}}}).fire()}),[e]),fireCacheUpdateSuccess:(0,n.useCallback)(((t,a)=>{e({type:"sendOperationalEvent",data:{source:"useSaveState",action:"success",actionSubject:"useSaveState update",attributes:{stateKey:t,stateValue:a,quickstartType:g,isStateRefactorEnabled:E}}}).fire()}),[e,g,E]),fireCacheUpdateError:(0,n.useCallback)(((t,a,{name:i,message:n})=>{e({type:"sendOperationalEvent",data:{source:"useSaveState",action:"failed",actionSubject:"useSaveState update",attributes:{stateKey:t,stateValue:a,errorName:i,errorMessage:n,quickstartType:g,isStateRefactorEnabled:E}}}).fire()}),[e,g,E]),fireLoadStateRefetchSuccess:(0,n.useCallback)((t=>{e({type:"sendOperationalEvent",data:{source:"useLoadState",action:"success",actionSubject:"useLoadState refetch",attributes:{quickstartType:g,refetchEventType:t}}}).fire()}),[e,g]),fireLoadStateRefetchError:(0,n.useCallback)(((t,{name:a,message:i})=>{e({type:"sendOperationalEvent",data:{source:"useLoadState",action:"failed",actionSubject:"useLoadState refetch",attributes:{errorName:a,errorMessage:i,quickstartType:g,refetchEventType:t}}}).fire()}),[e,g]),fireIneligibleQS:p}},g=()=>{const{createAnalyticsEvent:e}=(0,r._)(),{isNthUserQSEligible:t,isMigrationsQuickstartEligible:a,isJswXflowUserQSEligible:i,isAdmin:o,isNthUserQSV2Eligible:s}=(0,l.d)(),c=d(a(),t(),o&&i(),!o&&i(),s());return{fireOperationalSpotlightError:(0,n.useCallback)(((t,a,i)=>{e({type:"sendOperationalEvent",data:{source:a,action:"errored",actionSubject:"onboardingSpotlight",actionSubjectId:i,attributes:{message:t.message,quickstartType:c}}}).fire()}),[e,c])}}},584763:(e,t,a)=>{a.d(t,{lO:()=>f,bX:()=>b,S4:()=>_});var i=a(122551),n=a(499082),r=a(401487),o=a(722721),s=a(275281),c=a(158466),l=a(331377),d=a(161461);const u=l.ZP`query GetQuickstartState($key:[String]){onboardingState(key:$key){key value}...UserPermissionFragment}${d.M}`,E=l.ZP`mutation SetQuickstartState($key:String$value:String)@experimental{experimentalSetOnboardingState(key:$key value:$value){key value}}`;let g;!function(e){e.ANONYMOUS="ANONYMOUS",e.APP="APP",e.EXTERNAL="EXTERNAL",e.INTERNAL="INTERNAL",e.JSD="JSD"}(g||(g={}));var p=a(771458),T=a(201823);const S=e=>{const t={},{onboardingState:a}=e,i=(0,s.F)(e)===g.EXTERNAL;return i&&(t.isExternalCollaborator=i),void 0!==a&&a.forEach((({key:e,value:a})=>{const i=e.split(":")[1];a&&(/(true|false)/g.test(a)?t[i]="true"===a:t[i]=a)})),t},_=()=>{const{isCacheEnabled:e}=(0,T.d)(),{fireCacheUpdateSuccess:t,fireCacheUpdateError:a}=(0,p.lm)(),[i]=(0,n.Db)(E,{onError:e=>{"unauthorized"===e.graphQLErrors[0].message&&(0,r.Xb)(e)},update(i,{data:{experimentalSetOnboardingState:n}}){if(e){const{key:e,value:s}=n,c={key:Object.values(o.$x)};try{const a=i.readQuery({query:u,variables:c});a&&a.onboardingState&&(a.onboardingState.forEach((t=>{t.key===e&&(t.value=s)})),i.writeQuery({query:u,data:a,variables:c}),t(e,s))}catch(r){const{CACHE_UPDATE_FAILED:t}=o.pv;a(e,s,r),window.dispatchEvent(new Event(t))}}}});return[(e,t,a="quickstart-state:")=>{i({variables:{key:a+e,value:`${t}`},optimisticResponse:{experimentalSetOnboardingState:{__typename:"OnboardingState",key:a+e,value:`${t}`}}})}]},f=()=>{const{isCacheEnabled:e}=(0,T.d)(),{ONBOARDING_ATTRIBUTES_UPDATED:t,CACHE_UPDATE_FAILED:a}=o.pv,{fireLoadStateRefetchSuccess:r,fireLoadStateRefetchError:s}=(0,p.lm)(),[c,{called:l,data:d,error:E,loading:g,refetch:_}]=(0,n.td)(u,{fetchPolicy:e?"cache-first":"no-cache",variables:{key:Object.values(o.$x)}}),[f,b]=(0,i.useState)();(0,i.useEffect)((()=>{!l||g||E||b(S(d))}),[l,d,E,g]);const I=(0,i.useCallback)((e=>{const t=e.type;if(void 0!==_)try{_(),r(t)}catch(E){s(t,E)}}),[_,r,s]);return(0,i.useEffect)((()=>(window.addEventListener(t,I),e&&window.addEventListener(a,I),()=>{window.removeEventListener(t,I),e&&window.removeEventListener(a,I)})),[_,I,e]),{loadState:c,state:f,error:E,loading:g,refetch:_}},b=()=>{const{isLoggedIn:e,isLicensed:t}=(0,c.D)(),{data:a,error:i,loading:r}=(0,n.aM)(u,{fetchPolicy:"cache-first",variables:{key:Object.values(o.$x)},skip:!e||!t});let s;return!a||r||i||(s=S(a)),{state:s,error:i,loading:r}}},772443:(e,t,a)=>{a.d(t,{My:()=>i,nU:()=>n,up:()=>r,Ux:()=>o,VU:()=>s,KI:()=>c,zc:()=>l,lG:()=>d});const i=1130,n="confluenceOnboardingQuickstart",r="confluenceOnboardingQuickstartDrawer",o="confluenceOnboardingQuickstartButton",s="confluenceOnboardingQuickstartButtonDrawer",c="confluenceOnboardingQuickstartCta",l="confluenceOnboardingQuickstartCarouselAction",d={en:"https://player.vimeo.com/progressive_redirect/playback/676035490/rendition/1080p?loc=external&signature=1ce9207d5a6a8957d85834336f59c42c45b099c8320d3c60cdbfe2f526136ec2",jp:"https://player.vimeo.com/progressive_redirect/playback/738398214/rendition/1080p/file.mp4?loc=external&signature=b1d49a7d7a517d7d245e0d4018b4f4dba97d97c481ced019807dc97fa45631db",de:"https://player.vimeo.com/progressive_redirect/playback/738398180/rendition/1080p/file.mp4?loc=external&signature=29b5a66a0b5a5bc2ef65c6d11048328650ae4c963b29877ac9ab5abac47ef4a4",cn:"https://player.vimeo.com/progressive_redirect/playback/738398158/rendition/1080p/file.mp4?loc=external&signature=3f0f01307ffd26e49240387deb9b703d45cf59359b862dd8d1b68542c5d35166",br:"https://player.vimeo.com/progressive_redirect/playback/738398131/rendition/1080p/file.mp4?loc=external&signature=36299800fdbeefd42b2da49a887e804dbb9c2df500acaab07627f8d01521770f",ru:"https://player.vimeo.com/progressive_redirect/playback/738398112/rendition/1080p/file.mp4?loc=external&signature=26c0364851f5cb0d38d4396e5067473d825e8e633fd0cc204982fd3773f235b2",es:"https://player.vimeo.com/progressive_redirect/playback/738398078/rendition/1080p/file.mp4?loc=external&signature=596aa393f72a91d1485f7b36edf5a9e03e25a1350a923a870181c7cd1e92c21c",nl:"https://player.vimeo.com/progressive_redirect/playback/738398054/rendition/1080p/file.mp4?loc=external&signature=3927a84841c8b9bc1812797a72885a30c45c1749f661bbd15c01f09b067b5915",kr:"https://player.vimeo.com/progressive_redirect/playback/738398022/rendition/1080p/file.mp4?loc=external&signature=ab4e580c57f4f9ca990f1cd917a55a43ad0ed3f3c87cdc3e5592634eb5a6b213",pl:"https://player.vimeo.com/progressive_redirect/playback/738397991/rendition/1080p/file.mp4?loc=external&signature=869e4a87dc2f8d5bd49843d6066c8370dd3f1ca0a2a41e7d9334c9b63bab3d07",it:"https://player.vimeo.com/progressive_redirect/playback/738397952/rendition/1080p/file.mp4?loc=external&signature=1b7a167fff2b5c656f349ed89aac9c88a9224329d7c68835c76e519a7a5b713b",fr:"https://player.vimeo.com/progressive_redirect/playback/738397906/rendition/1080p/file.mp4?loc=external&signature=41b38194e902626c4a55d6ca7ec5ab4e267b395be78bcd15f5f1d0e86b083081"}},201823:(e,t,a)=>{a.d(t,{d:()=>I});var i=a(122551),n=a(158466),r=a(772610),o=a(732657);var s=a(546575),c=a(555543),l=a(485226),d=a(26011),u=a.n(d);var E=a(707967),g=a(764708),p=a(673009),T=a(197250),S=a(77243);var _=a(435083),f=a(772443),b=a(584763);const I=()=>{const{location:e,matchRoute:t}=(0,i.useContext)(r.M),{featureFlagClient:a,locale:d,userId:I,isLicensed:m}=(0,n.D)(),{isSiteAdmin:k}=(0,E.y)(),{isMigratedUser:v,isMigratedUserReady:A}=(0,s.z)(),{state:O}=(0,b.bX)(),{NTH_USER_QUICKSTART:N}=c.c,{name:R}=e&&e.pathname&&t(e.pathname)||{},C=(e=>!!e&&([/WHITEBOARD_HOME/,/WHITEBOARD_BOARD/,/LEGACY/,/ADMIN/,/^CALENDAR$/].every((t=>!t.test(e)))||[/VIEW_BLOG_DATE_LEGACY/].some((t=>t.test(e)))))(R),{width:D}=(()=>{const e="object"==typeof window,t=()=>({width:e?window.innerWidth:0,height:e?window.innerHeight:0}),[a,n]=(0,i.useState)(t);return(0,i.useEffect)((()=>{const e=u()((()=>{n(t())}),200);return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e),e.cancel()}}),[]),a})(),y=D>=f.My,L=k,h=C&&!(!I||!m)&&y;let M;try{M=(null==O?void 0:O.attributes)&&JSON.parse(null==O?void 0:O.attributes).originProduct}catch(B){M=""}const U="jira"===M,P=(0,l.C)(a,!1),q=(e=!1)=>P&&h&&!L&&((e,t,a=!0,i)=>{const n=(0,o.q3)(t,e,a);if(n===o.HX.ENROLLED)return!0;if(n===o.HX.EXPERIMENT)return!!/^en/i.test(i)&&(0,o.q3)(t,"confluence.frontend.onboarding.segment",a)===o.HX.EXPERIMENT;return!1})(N,a,e,d),G=(e=!1)=>P&&h&&!L&&((e,t,a)=>{const i=(0,T.q)(e,S.G.NTH_USER_QUICKSTART_V2,Boolean(a)&&(0,g.R)(t));return i===p.H.EXPERIMENT?(0,g.R)(t):i===p.H.ENROLLED})(a,d,e),Q=()=>P&&h&&L,w=(e=!1)=>P&&h&&!L&&A&&v&&((e,t,a=!0)=>!!(0,g.R)(t)&&(0,T.q)(e,S.G.MIGRATIONS_QUICKSTART,a)===p.H.ENROLLED)(a,d,e),x=(e=!1,t=!1)=>(U||t)&&P&&h&&"experiment"===a.getVariantValue(c.c.JSW_XFLOW_USER_QUICKSTART,{default:"control",shouldTrackExposureEvent:e,oneOf:["control","experiment","enrolled"]}),V=a.getBooleanValue(c.c.CACHE_ONBOADING_STATE,{default:!1}),F=(0,_.g)(a,d);return{isTarget:h,isAdmin:L,isOnboardingEligible:P,isQuickstartEligible:()=>P&&h&&(q()||x()||Q()||w()||G()),isNthUserQSEligible:q,isNthUserQSV2Eligible:G,isAdminQuickStartV2Eligible:Q,isMigrationsQuickstartEligible:w,isJswXflowUserQSEligible:x,isCacheEnabled:V,isStateRefactorEnabled:F}}}}]);
//# sourceMappingURL=1823.EmuqaBe5bk.js.map