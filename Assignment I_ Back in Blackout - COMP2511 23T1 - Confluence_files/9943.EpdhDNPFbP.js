/*! License: 9943.EpdhDNPFbP.js.LICENSE.txt */
(self._cf=self._cf||[]).push([[9943],{170250:(e,t,n)=>{var a=n(725719);e.exports=function(e,t){return!!(null==e?0:e.length)&&a(e,t,0)>-1}},904408:e=>{e.exports=function(e,t,n){for(var a=-1,i=null==e?0:e.length;++a<i;)if(n(t,e[a]))return!0;return!1}},841866:(e,t,n)=>{var a=n(630652),i=n(170250),s=n(904408),r=n(177968),o=n(458352),d=n(788370);e.exports=function(e,t,n,l){var g=-1,c=i,p=!0,u=e.length,h=[],m=t.length;if(!u)return h;n&&(t=r(t,o(n))),l?(c=s,p=!1):t.length>=200&&(c=d,p=!1,t=new a(t));e:for(;++g<u;){var f=e[g],v=null==n?f:n(f);if(f=l||0!==f?f:0,p&&v==v){for(var I=m;I--;)if(t[I]===v)continue e;h.push(f)}else c(t,v,l)||h.push(f)}return h}},697729:e=>{e.exports=function(e,t,n,a){for(var i=e.length,s=n+(a?1:-1);a?s--:++s<i;)if(t(e[s],s,e))return s;return-1}},725719:(e,t,n)=>{var a=n(697729),i=n(999079),s=n(545324);e.exports=function(e,t,n){return t==t?s(e,t,n):a(e,i,n)}},999079:e=>{e.exports=function(e){return e!=e}},935813:(e,t,n)=>{var a=n(630652),i=n(170250),s=n(904408),r=n(788370),o=n(939752),d=n(439363);e.exports=function(e,t,n){var l=-1,g=i,c=e.length,p=!0,u=[],h=u;if(n)p=!1,g=s;else if(c>=200){var m=t?null:o(e);if(m)return d(m);p=!1,g=r,h=new a}else h=t?[]:u;e:for(;++l<c;){var f=e[l],v=t?t(f):f;if(f=n||0!==f?f:0,p&&v==v){for(var I=h.length;I--;)if(h[I]===v)continue e;t&&h.push(v),u.push(f)}else g(h,v,n)||(h!==u&&h.push(v),u.push(f))}return u}},939752:(e,t,n)=>{var a=n(215867),i=n(231307),s=n(439363),r=a&&1/s(new a([,-0]))[1]==1/0?function(e){return new a(e)}:i;e.exports=r},545324:e=>{e.exports=function(e,t,n){for(var a=n-1,i=e.length;++a<i;)if(e[a]===t)return a;return-1}},724260:(e,t,n)=>{var a=n(818114),i=n(420879),s=n(957857),r=n(935813),o=n(830104),d=n(659945),l=s((function(e){var t=d(e);return o(t)&&(t=void 0),r(a(e,1,o,!0),i(t,2))}));e.exports=l},490398:(e,t,n)=>{var a=n(841866),i=n(957857),s=n(830104),r=i((function(e,t){return s(e)?a(e,t):[]}));e.exports=r},18958:(e,t,n)=>{"use strict";n.d(t,{_:()=>s});var a=n(122551),i=n(190188);const s=a.createContext({globalRegistry:i.oA,getStore:i.oA.getStore},(()=>0))},739946:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a={batchUpdates:"useSyncExternalStore"in n(122551),devtools:!1,middlewares:new Set,mutator:(e,t)=>Object.assign({},e,t)}},593237:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var a=n(413807);const i=e=>t=>n=>{let i;const s=e.getState(),r=t(s,n,(e=>{i=e}));return(0,a.Z)(r,s)||e.setState(r),i}},910711:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var a=n(153435),i=n(739946);const s=(e,t)=>{const n=window.__REDUX_DEVTOOLS_EXTENSION__.connect(Object.assign({name:`Store ${e.key}`,serialize:!0},t));return n.init(e.getState()),n.subscribe((t=>{if("DISPATCH"===t.type)switch(t.payload.type){case"RESET":return e.resetState(),void n.init(e.getState());case"COMMIT":return void n.init(e.getState());case"ROLLBACK":return e.setState(JSON.parse(t.state)),void n.init(e.getState());case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return void e.setState(JSON.parse(t.state))}else if("ACTION"===t.type){let n=JSON.parse(t.payload);e.setState(n.payload)}})),n},r=e=>function(){const t=e(...arguments);if(i.Z.devtools&&window&&window.__REDUX_DEVTOOLS_EXTENSION__){const e=t.mutator;let n;const a=a=>{const r=e(a);try{if(!n){const e="function"==typeof i.Z.devtools?i.Z.devtools(t):{};n=s(t,e)}n.send({type:t.mutator.actionName,payload:a},t.getState(),{},t.key)}catch(o){}return r};t.mutator=a}return t};var o=n(833486),d=n(620298);const l={scheduling:()=>"undefined"!=typeof window&&"function"==typeof MessageChannel};let g=!1;function c(e){return i.Z.batchUpdates&&l.scheduling()&&!g?(g=!0,(0,d.unstable_scheduleCallback)(d.unstable_ImmediatePriority,(function(){(0,o.unstable_batchedUpdates)(e),g=!1}))):(0,o.unstable_batchedUpdates)(e)}const p=[];let u;const h=r((function(e,t){let n=[],s=t;const r={key:e,getState:()=>s,setState(e){s=e,function(e){if(!i.Z.batchUpdates||!l.scheduling())return c((()=>e()));p.includes(e)||p.push(e),u||(u=c((()=>{let e;for(;e=p.shift();)e();u=null})))}(r.notify)},resetState(){r.setState(t)},notify(){for(let e=0;e<n.length;e++)n[e](r.getState())},subscribe:e=>(n=n.concat(e),function(){n=n.filter((t=>t!==e))}),listeners:()=>n};return r.mutator=(0,a.Z)(r,i.Z.middlewares),r}))},185858:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});var a=n(158101);function i(e){let t,{name:n="",initialState:i,actions:s}=e;return{get key(){return t||(t=function(e,t,n){const i=n?"":Object.keys(t).reduce(((e,n)=>e+t[n].toString()),"");return[n,(0,a.Z)(i+JSON.stringify(e))].filter(Boolean).join("__")}(i,s,n))},initialState:i,actions:s}}},101266:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var a=n(413807);function i(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;if(e&&2===t.length)return t[0]===n[0]&&(0,a.Z)(t[1],n[1]);for(let a=0;a<t.length;a++)if(i=t[a],s=n[a],i!==s)return!1;var i,s;return!0}function s(e,t){void 0===t&&(t=!1);let n,s=[],r=!1;return function(){if(r&&i(t,arguments,s))return n;const o=e.apply(this,arguments);return!t&&(0,a.Z)(o,n)||(n=o,r=!0,s=arguments),n}}},761955:(e,t,n)=>{"use strict";var a=n(122551);var i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=a.useState,r=a.useEffect,o=a.useLayoutEffect,d=a.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(a){return!0}}var g="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),a=s({inst:{value:n,getSnapshot:t}}),i=a[0].inst,g=a[1];return o((function(){i.value=n,i.getSnapshot=t,l(i)&&g({inst:i})}),[e,n,t]),r((function(){return l(i)&&g({inst:i}),e((function(){l(i)&&g({inst:i})}))}),[e]),d(n),n};t.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:g},497803:(e,t,n)=>{"use strict";e.exports=n(761955)},940362:(e,t,n)=>{"use strict";n.d(t,{ck:()=>a,o2:()=>i,cu:()=>s,yG:()=>r,xl:()=>o,fZ:()=>d,Ex:()=>l,hM:()=>g,cT:()=>c,Ck:()=>p,Ho:()=>u,GR:()=>h,$u:()=>m,Up:()=>f,lr:()=>v,gX:()=>I,EE:()=>P,p$:()=>S,Ku:()=>b,Qf:()=>y,qi:()=>E,iC:()=>x});const a="SSR_COMMENT_BUTTON",i="SSR_SHARE_BUTTON",s="SSR_REACTIONS_BUTTON",r="SSR_WATCH_BUTTON",o="SSR_FAVORITE_BUTTON",d="SSR_EDIT_BUTTON",l="SSR_RESTRICTIONS_BUTTON",g="SSR_NAV_APP_SWITCHER",c="SSR_NAV_APPS_BUTTON",p="SSR_NAV_CREATE",u="SSR_NAV_CUSTOM_HOMEPAGE_BUTTON",h="SSR_NAV_HELP",m="SSR_NAV_HOME_BUTTON",f="SSR_NAV_NOTIFICATIONS",v="SSR_NAV_PAGES_BUTTON",I="SSR_NAV_PEOPLE_BUTTON",P="SSR_NAV_PROFILE",S="SSR_NAV_SETTINGS",b="SSR_NAV_SPACES_BUTTON",y="SSR_NAV_TEMPLATES_BUTTON",E="SSR_PAGE_TREE_NON_LINK",x="SSR_NAV_INVITE_BUTTON"},756850:(e,t,n)=>{"use strict";n.d(t,{p:()=>s});var a=n(122551);const i=(0,n(28201).ZR)({__loadable_id__:"ypXKg",name:"PageTreeTooltip",loader:async()=>(await n.e(98614).then(n.bind(n,562221))).PageTreeTooltip,loading:({children:e})=>a.createElement(a.Fragment,null,e)}),s=({isHoverPageCardOptedIn:e,children:t,title:n,isQuickActionsOpen:s})=>e?a.createElement(a.Fragment,null,t):a.createElement(i,{title:n,isQuickActionsOpen:s},t)},803384:(e,t,n)=>{"use strict";n.d(t,{$:()=>a});const a=(0,n(28201).ui)({__loadable_id__:"WGMMX",name:"PageTreeAfterIconLoader",loader:async()=>(await Promise.all([n.e(12705),n.e(61769),n.e(30951)]).then(n.bind(n,299155))).PageTreeAfterIcon})},99687:(e,t,n)=>{"use strict";n.d(t,{x:()=>x});var a=n(29298),i=n(790632),s=n(122551),r=n(883383),o=n(905657),d=n(460215),l=n(685753),g=n(28201);const c=(0,g.ZR)({__loadable_id__:"BTa2z",name:"TreeLoader",loader:async()=>(await Promise.all([n.e(12705),n.e(53561)]).then(n.bind(n,840379))).Tree}),p=(0,g.ZR)({__loadable_id__:"hAWs4",name:"TreeMonitorLoader",loader:async()=>(await Promise.all([n.e(99798),n.e(40187)]).then(n.bind(n,108436))).TreeMonitor});var u=n(661315),h=n(940362);const m=(0,i.Z)("div",{target:"ebxerkm0"})({name:"1ly8aii",styles:"display:flex;flex-direction:column;flex-grow:1;flex-shrink:0;align-items:flex-start;"});var f=n(44127);const v=(0,g.ZR)({__loadable_id__:"kMdoC",name:"AkTreeLoader",loader:async()=>await Promise.all([n.e(11216),n.e(11956),n.e(41342),n.e(3350)]).then(n.bind(n,195986))}),I=(0,i.Z)("div",{target:"e11xs6zb0"})({name:"ukqx1j",styles:"flex-grow:1;flex-shrink:0;width:100%;display:flex;flex-direction:column;> div{flex-grow:1;width:100%;}"}),P={[f.Xx]:"none",[f.Uc]:"0%",[f.rn]:"transparent"},S=(0,i.Z)(d.Z,{target:"e11xs6zb1"})({name:"1yucc92",styles:"overflow:hidden;min-width:0;width:calc(100% - 5px);&:before{height:0px;}display:flex;flex-grow:1;flex-direction:column;padding-left:5px;"}),b=(0,i.Z)("div",{target:"e11xs6zb2"})({name:"1uty0ys",styles:"margin:10px 0 10px 0;width:100%;"}),y=(0,i.Z)("div",{target:"e11xs6zb3"})({name:"1ik2tog",styles:"width:100%;min-height:200px;display:flex;justify-content:center;align-items:center;flex-grow:1;"}),E=(0,s.memo)((({loadMorePages:e})=>s.createElement(b,null,s.createElement(o.Z,{shouldFitContainer:!0,spacing:"compact",onClick:e},s.createElement(r.Z,{id:"page-tree.pages.show.all",defaultMessage:"Show all pages"})))));class x extends s.PureComponent{constructor(...e){super(...e),(0,a.Z)(this,"onInitialLoadCompleteSubmitted",!1),(0,a.Z)(this,"collapsePage",(e=>{const{tree:t,onCollapse:n}=this.props;n(t.items[e])})),(0,a.Z)(this,"expandPage",(e=>{const{tree:t,onExpand:n}=this.props;n(t.items[e])})),(0,a.Z)(this,"dragStart",(e=>{const{onDragStart:t}=this.props;t(e)})),(0,a.Z)(this,"dragEnd",(async(e,t)=>{const{onDragEnd:n}=this.props;n(e,t)}))}componentDidMount(){const{tree:e,refactor:t}=this.props;var n,a;t&&Object.keys(e.items).length&&(null===(n=(a=this.props).onInitialLoadComplete)||void 0===n||n.call(a,Object.keys(e.items).length),this.onInitialLoadCompleteSubmitted=!0)}componentDidUpdate(e){if(this.onInitialLoadCompleteSubmitted)return;const{tree:t}=this.props;var n,a;(e.loading&&!this.props.loading||window.__SSR_RENDERED__)&&(null===(n=(a=this.props).onInitialLoadComplete)||void 0===n||n.call(a,Object.keys(t.items).length),this.onInitialLoadCompleteSubmitted=!0)}render(){const{tree:e,loadMorePages:t,isTreeTruncated:n,isDraggable:a,treeWrapperComponent:i,loading:r,isPragmaticDnDEnabled:o,isDraggingItem:d}=this.props,g=n?s.createElement(E,{loadMorePages:t}):null,f=null!=i?i:s.Fragment,b=s.createElement(S,null,r?s.createElement(y,null,s.createElement(l.Z,{size:"medium",testId:"page-tree-loading"})):s.createElement(s.Fragment,null,g,s.createElement(f,null,s.createElement(I,{style:o&&d?P:void 0,"data-testid":"tree-container-flex"},o?s.createElement(s.Fragment,null,s.createElement(c,{tree:e,isDragEnabled:a,renderItem:this.props.renderItem,onExpand:this.expandPage,onCollapse:this.collapsePage,onDragStart:this.dragStart,onDragEnd:this.dragEnd,offsetPerLevel:24}),s.createElement(p,{setIsDraggingItem:this.props.setIsDraggingItem,setOpenQuickActionsId:this.props.setOpenQuickActionsId})):s.createElement(v,{tree:e,isDragEnabled:a,renderItem:this.props.renderItem,onExpand:this.expandPage,onCollapse:this.collapsePage,onDragStart:this.dragStart,onDragEnd:this.dragEnd,offsetPerLevel:24,isNestingEnabled:!0}))),g));return s.createElement(u.u,{metricName:h.qi},s.createElement(m,null,b))}}x.displayName="PageTreeComponent"},839323:(e,t,n)=>{"use strict";n.d(t,{L:()=>Z});var a=n(991332),i=n(29298),s=n(122551),r=n(405124),o=n.n(r),d=n(69210),l=n(514645),g=n(378314),c=n(658350),p=n(961634),u=n(401487),h=n(13089),m=n(590726),f=n(90995),v=n(28201),I=n(802059),P=n(960284),S=n(625764),b=n(99687),y=n(577864),E=n(612726),x=n(890441);const T=(0,v.ui)({__loadable_id__:"AVAta",name:"PageTreeErrorComponentLoader",loader:async()=>(await n.e(41536).then(n.bind(n,34738))).PageTreeErrorComponent});let C={spaceKey:null,rootId:null,pages:{}};class Z extends s.PureComponent{constructor(...e){super(...e),(0,i.Z)(this,"state",{expandedPages:new Set,loadingPages:new Set,pages:{},space:null,spaceKey:null,rootId:null,initialLoading:!window.__SSR_RENDERED__,loadingMorePages:!1,isTreeTruncated:!1,initialCursors:null,initialPages:null,error:null,blogPeekRoot:void 0}),(0,i.Z)(this,"scrolledItemId",null),(0,i.Z)(this,"highlightedPages",[]),(0,i.Z)(this,"querySubscription",null),(0,i.Z)(this,"getFocusedPageId",(()=>this.state.blogPeekRoot||this.props.currentPageId||this.props.highlightPages[0])),(0,i.Z)(this,"queryChildren",((e,t,n={count:0,nodes:[]})=>this.props.apolloClient.query({query:S.i,fetchPolicy:"no-cache",variables:{contentId:e,statuses:this.props.statuses,first:x.P_,after:t,isSuperAdmin:this.props.isSuperAdmin||!1}}).then((t=>{const{children:a}=t.data.page,i=(0,I.XJ)(n,a);return a.pageInfo.hasNextPage?this.queryChildren(e,a.pageInfo.endCursor,i):i})))),(0,i.Z)(this,"reloadChildren",(()=>{this.queryChildren(this.getFocusedPageId())})),(0,i.Z)(this,"getPageQueryObservable",((e,t,n=!1,i=!1)=>{const{detached:s,statuses:r}=this.props,o=e?y.w:E.c,d=e?{spaceKey:t,isSuperAdmin:i,statuses:r,ptStatuses:r,contentId:e}:{spaceKey:t,isSuperAdmin:i,statuses:r,emojiTitleEnabled:!0},l=(0,a.Z)({paginationLimit:x.Nx},d);return this.props.apolloClient.watchQuery({fetchPolicy:s?"no-cache":"cache-and-network",query:o,variables:!0!==n&&e?d:l})})),(0,i.Z)(this,"correctTreeFlattener",((e,t)=>e?(0,P.oH)(e,t):(0,P.G3)(t))),(0,i.Z)(this,"handleSyntheticItem",((e,t,n,i)=>{if(t=(0,a.Z)({},t),e&&e.id){var s;t[e.id]||t[n].children.some((t=>t===e.id))||(t[n]=(0,a.Z)((0,a.Z)({},t[n]),{},{children:[e.id,...t[n].children]}));const r=(null===(s=t[e.id])||void 0===s?void 0:s.data)||{};t[e.id]=(0,a.Z)((0,a.Z)({},e),{},{data:i?(0,a.Z)((0,a.Z)({},r),e.data):(0,a.Z)((0,a.Z)({},e.data),r)})}return t})),(0,i.Z)(this,"reloadForBlogPeekFN",((e,t)=>{var n;e&&"noHomepageFound"!==t&&(null===(n=this.querySubscription)||void 0===n||n.unsubscribe(),this.loadPages())})),(0,i.Z)(this,"conditionallyStartLoading",((e,t,n=!1)=>{(e&&!t&&!this.state.initialLoading&&Object.keys(C.pages).length<=0||n)&&this.setState({initialLoading:!0})})),(0,i.Z)(this,"conditionallyEndLoading",((e,t)=>{e&&!t||this.setState({initialLoading:!1})})),(0,i.Z)(this,"loadPages",(async(e=!1,t=!1)=>{const{spaceKey:n,isPeekingFromBlogs:a,isSuperAdmin:i,expandSpaceHomepage:s,syntheticItem:r,detached:o,syntheticItemIsDraft:d}=this.props,l=this.getFocusedPageId(),g=a&&void 0===this.state.blogPeekRoot,c=this.getPageQueryObservable(l,n,e,i);this.querySubscription=c.subscribe({next:({data:e,loading:i})=>{if(this.conditionallyStartLoading(i,e,t||o),e&&Object.keys(e).length>0){var l;const{currentPage:t,rootLevelPages:i,space:o}=e,c=this.correctTreeFlattener(t,i),p=(0,I.EH)(t,{});let u=(0,I.Gv)(this.state.pages,c);const h=null==o||null===(l=o.homepage)||void 0===l?void 0:l.id,m=(0,I.nJ)(u,null==t?void 0:t.id,h),f=a?o.homepage&&o.homepage.id||"noHomepageFound":void 0;u=this.handleSyntheticItem(r,u,m,d),this.setState({expandedPages:this.determineInitiallyExpandedPages(c),rootId:m,pages:u,space:o,spaceKey:n,isTreeTruncated:(0,I.HM)(t),initialCursors:p,initialPages:t,blogPeekRoot:f}),this.reloadForBlogPeekFN(g,f),s&&h&&m!==h&&u[h]&&this.expandPage(u[h])}this.conditionallyEndLoading(i,e)},error:e=>this.handleLoadingError(e)})})),(0,i.Z)(this,"loadMorePages",(async()=>{const{spaceKey:e,onLoadMore:t,isSuperAdmin:n}=this.props,a=this.getFocusedPageId();this.setState({loadingMorePages:!0});const{initialCursors:i,initialPages:s}=this.state,{mergedPages:r,rootLevelPages:o}=await this.loadAllPages(a,e,n,i,s),d=(0,P.oH)(r,o);this.setState({spaceKey:e,pages:d,isTreeTruncated:!1,loadingMorePages:!1}),t&&t()})),(0,i.Z)(this,"loadAllPages",((e,t,n,i,s)=>{const{statuses:r}=this.props,o=(0,a.Z)({contentId:e,spaceKey:t,isSuperAdmin:n,statuses:r,ptStatuses:r},i);return this.props.apolloClient.query({query:y.w,variables:o}).then((a=>{const{data:r,error:o}=a;if(o)this.handleLoadingError(o);else if(r&&Object.keys(r).length>0){const{currentPage:a,rootLevelPages:o}=r,d=(0,I.y4)(a,s);if((0,I.HM)(a)){const s=(0,I.EH)(a,i);return this.loadAllPages(e,t,n,s,d)}return{mergedPages:d,rootLevelPages:o}}}))})),(0,i.Z)(this,"determineInitiallyExpandedPages",(e=>{const{expandedPages:t}=this.state;for(const n in e){const a=e[n];a.hasChildren&&(0,I.Ny)(a)&&t.add(a.id)}return t})),(0,i.Z)(this,"expandPage",(async e=>{const{pages:t,expandedPages:n,loadingPages:a,space:i}=this.state,s=t[e.id];if(n.has(e.id)||!s.hasChildren)return;const r=[e.id,...(0,I.pL)(e.id,t,n)];if(!(0,I.Ny)(s)){this.setState({loadingPages:a.add(s.id)});const e={},n=(0,I.UQ)(await this.queryChildren(s.id));n.forEach((t=>{e[t.id]=(0,P.sq)(t)}));let r=(0,I.Gv)(t,e);a.delete(s.id);const o=(0,I.s3)(n);this.props.syntheticItem&&s.data.hasSyntheticChild&&(o.push(this.props.syntheticItem.id),r=(0,l.ZP)(r,(e=>{e[s.id].data.hasSyntheticChild=!1})));const d=(0,P.IX)(r,s.id,o);this.setState({loadingPages:a,pages:d},(()=>{const{onExpand:e}=this.props;e&&e(d[s.id],{spaceId:null==i?void 0:i.id})}))}this.setState({expandedPages:new Set(r)})})),(0,i.Z)(this,"collapsePage",(e=>{const{expandedPages:t,space:n}=this.state,{onCollapse:a}=this.props;t.delete(e.id),this.setState({expandedPages:t}),a&&a(e,{spaceId:null==n?void 0:n.id})})),(0,i.Z)(this,"determineMovePageParams",((e,t,n)=>{if(void 0===n.index)return{pageId:t,parentId:n.parentId};const a=0===n.index,i=e.children.indexOf(t),s=i>-1&&i<n.index,r=a||s?n.index:n.index-1;return{pageId:t,siblingId:String(e.children[r]),positionToSibling:0===n.index?"before":"after"}})),(0,i.Z)(this,"movePage",((e,t)=>{var n,a,i,s,r;const{pages:o}=this.state,d=this.validateMove(e,t);if(null!==d)return void(this.props.onMoveInvalid&&this.props.onMoveInvalid({reason:d}));const l=(null===(n=this.props.syntheticItem)||void 0===n?void 0:n.id)||o[e.parentId].children[e.index],g=(null===(a=o[l])||void 0===a||null===(i=a.data)||void 0===i?void 0:i.status)||null,c=o[t.parentId],p=o[e.parentId],u=l===(null===(s=this.props.syntheticItem)||void 0===s?void 0:s.id);this.movePageInState(l,e,t,u);const h=this.determineMovePageParams(c,l,t);this.props.onPageMove(h,{contentStatus:g,destination:t,movedPageTitle:o[l].data.title,source:e,sourceParent:p,spaceId:null===(r=this.state.space)||void 0===r?void 0:r.id,revertMove:()=>{const{pages:n}=this.state,a=n[p.id],i=a.children.length>0?e:{parentId:p.id};return this.movePageInState(l,t,i,!0),this.determineMovePageParams(a,l,i)}})})),(0,i.Z)(this,"onClick",(async e=>{if(!this.props.syntheticItem)return;const t=this.props.syntheticItem.id;if(e.id===t)return;const{pages:n}=this.state,a=Object.keys(n).find((e=>n[e].data.hasSyntheticChild||n[e].children.includes(t)));if(!a)return;const i={parentId:a,index:n[a].children.indexOf(t)},s={parentId:e.id};-1!==i.index&&this.movePage(i,s)})),(0,i.Z)(this,"handleLoadingError",(e=>{if(!e)return;const t={apolloError:e};(0,h.rw)(e)&&((0,u.Xb)(e),t.isExpected=!0),this.setState({error:t});const{onLoadError:n}=this.props;n&&n(e,{isExpected:t.isExpected})})),(0,i.Z)(this,"renderItem",(0,d.default)((e=>t=>this.props.renderItem((0,a.Z)((0,a.Z)({},t),{},{spaceHomePageId:e,onClick:this.onClick,updateSinglePage:this.updateSinglePage}))))),(0,i.Z)(this,"onDragStart",(()=>{const{pages:e}=this.state,{onDragStart:t,onMoveInvalid:n}=this.props;t&&t(),Object.keys(e).length>x.D2&&(window.dispatchEvent(new Event("scroll")),n&&n({reason:"TREE_TOO_LARGE"}))})),(0,i.Z)(this,"isDraggable",(e=>this.props.isDraggable(e,{space:this.state.space}))),(0,i.Z)(this,"updateSinglePage",((e,t)=>{const{pages:n}=this.state,i=(0,a.Z)((0,a.Z)({},n[e]),{},{data:(0,a.Z)((0,a.Z)({},n[e].data),t)});this.setState({pages:(0,a.Z)((0,a.Z)({},n),{},{[e]:i})})}))}static getDerivedStateFromProps(e,t){const{currentPageId:n,highlightPages:i,spaceKey:s}=e,{expandedPages:r,loadingPages:o,pages:d}=t;return Object.keys(d).length<=0&&Object.keys(C.pages).length>0&&C.spaceKey===s?(0,a.Z)((0,a.Z)({},t),{},{spaceKey:s,initialLoading:!1,pages:C.pages,rootId:C.rootId||null}):(0,a.Z)((0,a.Z)({},t),{},{pages:(0,P.xl)(d,n,r,o,i)})}componentDidMount(){this.loadPages(!0),this.updatePageTreeMetadata()}componentDidUpdate(e){const{currentPageId:t,spaceKey:n,highlightPages:a,forceFetchCurrentPage:i,forceFetchedCallback:s,shouldPersistPageTreeObject:r}=this.props,{pages:d,spaceKey:l,rootId:g}=this.state;r&&(C={spaceKey:l,pages:d,rootId:g});let c=!1;if(t&&(i||e.currentPageId!==t)){const e=d[t];!e||i||n!==l?(c=!0,this.loadPages(!0,i).then((()=>{i&&s&&s()}))):this.expandPage(e)}if(a.length&&!o()(e.highlightPages,a)){const e=d[a[0]];e||c?e&&this.expandPage(e):this.loadPages(!0,!0)}this.updatePageTreeMetadata()}componentWillUnmount(){this.querySubscription&&this.querySubscription.unsubscribe()}movePageInState(e,t,n,i){const{rootId:s,pages:r,expandedPages:o}=this.state;let d={rootId:s,items:r};const l=d.items[n.parentId];if(void 0===t.index){const a=r[t.parentId],i=a.children.indexOf(e);if(-1!==i){const e=[...a.children];e.splice(i,1),d=(0,g.U)(d,t.parentId,{children:e,hasChildren:e.length>0,isExpanded:e.length>0&&a.isExpanded})}const s=[...d.items[n.parentId].children];s.splice(n.index,0,e),d=(0,g.U)(d,n.parentId,{children:s,hasChildren:!0})}else{var p;e===(null===(p=this.props.syntheticItem)||void 0===p?void 0:p.id)&&!l.isExpanded&&l.hasChildren&&0===l.children.length&&(d=(0,g.U)(d,l.id,{data:(0,a.Z)((0,a.Z)({},l.data),{},{hasSyntheticChild:!0})})),d=(0,c.d)(d,t,n)}0===d.items[t.parentId].children.length&&o.delete(t.parentId),this.setState({pages:d.items,rootId:d.rootId,expandedPages:o},(()=>{i&&this.expandPage(l)}))}validateMove(e,t){const{pages:n}=this.state;return t&&!o()(e,t)&&n[t.parentId]?"DRAFT"===n[t.parentId].data.status?"INVALID_MOVE_LOCATION_DRAFT":Object.keys(n).length>=x.D2?"TREE_TOO_LARGE":null:"INVALID_MOVE_LOCATION"}updatePageTreeMetadata(){var e;const{pages:t,initialLoading:n,loadingMorePages:a,space:i}=this.state,{setHasItemsToDisplay:s=(()=>{}),setIsViewingSpaceHomepage:r=(()=>{}),setIsPageTreeLoading:o=(()=>{})}=this.props,d=null==i||null===(e=i.homepage)||void 0===e?void 0:e.id,l=this.getFocusedPageId();o(n||a),s(Object.keys(t).length>0),r(l===d)}render(){var e;const{pages:t,rootId:n,space:a,initialLoading:i,loadingMorePages:r,isTreeTruncated:o,error:d}=this.state,{treeWrapperComponent:l}=this.props;return d?s.createElement(s.Fragment,null,s.createElement(T,null),!d.isExpected&&s.createElement(p.X,{error:d.apolloError})):s.createElement(s.Fragment,null,s.createElement(b.x,{isDraggable:this.isDraggable,isTreeTruncated:o,loadMorePages:this.loadMorePages,onCollapse:this.collapsePage,onDragStart:this.onDragStart,onDragEnd:this.movePage,onExpand:this.expandPage,onInitialLoadComplete:this.props.onInitialLoadComplete,tree:{rootId:n,items:t},treeWrapperComponent:l,loading:r||i,renderItem:this.renderItem(null==a||null===(e=a.homepage)||void 0===e?void 0:e.id),setIsDraggingItem:this.props.setIsDraggingItem,setOpenQuickActionsId:this.props.setOpenQuickActionsId}),s.createElement(m.h,{name:"pagetree",types:[f.ai.content],reload:this.reloadChildren}))}}Z.displayName="PageTreeController",(0,i.Z)(Z,"defaultProps",{highlightPages:[],forceFetchCurrentPage:!1,shouldPersistPageTreeObject:!0})},865586:(e,t,n)=>{"use strict";n.d(t,{Cj:()=>B,_9:()=>q});var a=n(953307),i=n(991332),s=n(122551),r=n(405124),o=n.n(r),d=n(499082),l=n(590726),g=n(90995),c=n(271128),p=n(483565),u=n(185858),h=n(342851),m=n(704951),f=n(514645),v=n(658350),I=n(378314),P=n(13089),S=n(401487);function b(e,t,n){const{items:a}=e,s=(0,i.Z)({},a),r=[...s[t.parentId].children];r.splice(t.index,1),s[t.parentId]=(0,i.Z)((0,i.Z)({},s[t.parentId]),{},{children:r,hasChildren:Boolean(r.length)});const o=s[n.parentId],d=[...o.children],l=a[t.parentId].children[t.index];var g;return void 0===n.index?((g=o).hasChildren&&g.children.length>0||function(e){return!e.hasChildren}(o))&&d.push(l):d.splice(n.index,0,l),s[n.parentId]=(0,i.Z)((0,i.Z)({},s[n.parentId]),{},{children:d,hasChildren:!0}),(0,i.Z)((0,i.Z)({},e),{},{items:s})}const y=(e,t,n)=>{const a=e.items[t];return a?{rootId:e.rootId,items:(0,i.Z)((0,i.Z)({},e.items),{},{[t]:(0,i.Z)((0,i.Z)({},a),n)})}:e};var E=n(960284),x=n(802059);const T={expandedPages:new Set,loadingPages:new Set,pages:{},space:null,spaceKey:null,rootId:null,isTreeTruncated:!1,cursors:{},initialPages:{},error:null,blogPeekRoot:void 0,focusedPageId:null,isPageTreeLoading:!0};let C=T;const Z={initializeState:()=>({setState:e,dispatch:t},{currentPageId:n,spaceKey:a,highlightPages:s=[],initialData:r,isPeekingFromBlogs:o,syntheticItem:d,syntheticItemIsDraft:l,detached:g})=>{if((e=>Object.keys(C.pages).length>0&&C.spaceKey===e)(a)&&!g)e((0,i.Z)((0,i.Z)({},C),{},{pages:(0,E.xl)(C.pages,n,C.expandedPages,C.loadingPages,s)}));else if(r&&Object.keys(r).length>0){const e=(0,E.Tu)(r,a,(0,i.Z)((0,i.Z)({},T),{},{expandedPages:new Set,loadingPages:new Set}),o,d,l);t(Z.setStateWithUIAttributes(e)),t(Z.setIsPageTreeLoading(!1))}else e((0,i.Z)((0,i.Z)({},T),{},{expandedPages:new Set,loadingPages:new Set,spaceKey:a}))},getState:()=>({getState:e})=>e(),derivedStateFromPropsReplacement:()=>({dispatch:e,getState:t},{currentPageId:n,highlightPages:a=[],spaceKey:i})=>{const{pages:s,expandedPages:r,loadingPages:o}=t();e(Z.setStateWithUIAttributes({pages:(0,E.xl)(s,n,r,o,a),spaceKey:i}))},updatePersistedState:()=>({getState:e},{detached:t})=>{if(!t){const t=e();C=t}},setStateWithUIAttributes:e=>({setState:t,getState:n,dispatch:a},{currentPageId:s,highlightPages:r=[]})=>{t((0,i.Z)({},e));const{pages:o,expandedPages:d,loadingPages:l}=n();t({pages:(0,E.xl)(o,s,d,l,r)}),a(Z.setFocusPageId())},addLoadingPage:e=>({getState:t,dispatch:n})=>{n(Z.setStateWithUIAttributes({loadingPages:t().loadingPages.add(e)}))},setIsPageTreeLoading:e=>({setState:t})=>{t({isPageTreeLoading:e})},setIsTreeTruncated:e=>({setState:t})=>{t({isTreeTruncated:e})},deleteLoadingPage:e=>({getState:t,dispatch:n})=>{const{loadingPages:a}=t();a.delete(e),n(Z.setStateWithUIAttributes({loadingPages:a}))},expandPage:(e,t)=>async({getState:n,dispatch:a},{syntheticItem:i,onExpand:s})=>{const{pages:r,expandedPages:o,loadingPages:d,space:l}=n(),g=r[e.id];if(o.has(e.id)||!g.hasChildren)return;const c=[e.id,...(0,x.pL)(e.id,r,o)];if(!(0,x.Ny)(g)){a(Z.setStateWithUIAttributes({loadingPages:d.add(g.id)}));const e={},n=(0,x.UQ)(await t(g.id));n.forEach((t=>{e[t.id]=(0,E.sq)(t)}));let o=(0,x.Gv)(r,e);d.delete(g.id);const c=(0,x.s3)(n);i&&g.data.hasSyntheticChild&&(c.push(i.id),o=(0,f.ZP)(o,(e=>{e[g.id].data.hasSyntheticChild=!1})));const p=(0,E.IX)(o,g.id,c);a(Z.setStateWithUIAttributes({loadingPages:d,pages:p})),s&&s(p[g.id],{spaceId:null==l?void 0:l.id})}a(Z.setStateWithUIAttributes({expandedPages:new Set(c)}))},collapsePage:(e,t)=>({getState:n,dispatch:a})=>{const{expandedPages:i,space:s}=n();i.delete(e.id),a(Z.setStateWithUIAttributes({expandedPages:i})),t&&t(e,{spaceId:null==s?void 0:s.id})},movePageInState:(e,t,n,a,s,r)=>({getState:o,dispatch:d},{syntheticItem:l})=>{const{rootId:g,pages:c,expandedPages:p}=o();let u={rootId:g,items:c};const h=u.items[n.parentId];if(void 0===t.index)if(r)u=((e,t,n)=>{const a=e.items[t],i=a.children.filter((e=>e!==n));return i.length!==a.children.length?y(e,t,{children:i,hasChildren:i.length>0,isExpanded:i.length>0&&a.isExpanded}):e})(u,t.parentId,e),u=((e,t,n,a)=>{const i=[...e.items[t].children];return i.splice(a,0,n),y(e,t,{children:i,hasChildren:!0})})(u,n.parentId,e,n.index);else{const a=c[t.parentId],i=a.children.indexOf(e);if(-1!==i){const e=[...a.children];e.splice(i,1),u=(0,I.U)(u,t.parentId,{children:e,hasChildren:e.length>0,isExpanded:e.length>0&&a.isExpanded})}const s=[...u.items[n.parentId].children];s.splice(n.index,0,e),u=(0,I.U)(u,n.parentId,{children:s,hasChildren:!0})}else{e===(null==l?void 0:l.id)&&!h.isExpanded&&h.hasChildren&&0===h.children.length&&(r?(m=u,f=h.id,P={hasSyntheticChild:!0},u=y(m,f,{data:(0,i.Z)((0,i.Z)({},m.items[f].data),P)})):u=(0,I.U)(u,h.id,{data:(0,i.Z)((0,i.Z)({},h.data),{},{hasSyntheticChild:!0})}));u=(r?b:v.d)(u,t,n)}var m,f,P;0===u.items[t.parentId].children.length&&p.delete(t.parentId),d(Z.setStateWithUIAttributes({pages:u.items,rootId:u.rootId,expandedPages:p})),s&&d(Z.expandPage(h,a))},handleLoadingError:e=>({setState:t},{onLoadError:n})=>{if(!e)return;const a={apolloError:e};(0,P.rw)(e)&&((0,S.Xb)(e),a.isExpected=!0),t({error:a}),n&&n(e,{isExpected:a.isExpected})},updateSinglePage:(e,t)=>({getState:n,dispatch:a})=>{const{pages:s}=n(),r=(0,i.Z)((0,i.Z)({},s[e]),{},{data:(0,i.Z)((0,i.Z)({},s[e].data),t)});a(Z.setStateWithUIAttributes({pages:(0,i.Z)((0,i.Z)({},s),{},{[e]:r})}))},setFocusPageId:()=>({getState:e,setState:t},{currentPageId:n,highlightPages:a=[]})=>{const{blogPeekRoot:i}=e();t({focusedPageId:i||n||a[0]})}},w=(0,u.M)({initialState:(0,i.Z)((0,i.Z)({},T),{},{expandedPages:new Set,loadingPages:new Set}),actions:Z,name:"pageTreeState"}),A=(0,h.f)(w,{onInit:Z.initializeState,onUpdate:Z.derivedStateFromPropsReplacement}),_=(0,m.Bi)(w);var D=n(99687),k=n(577864),L=n(612726),M=n(890441);const R=({statuses:e})=>{const[t,n]=_(),a=(e=>{const{refetch:t}=(0,d.aM)(e,{skip:!0});return(0,s.useCallback)((e=>t(e)),[t])})(k.w),r=(0,s.useCallback)(((t,s,o,d,l)=>a((0,i.Z)({contentId:t,spaceKey:s,isSuperAdmin:o,statuses:e,ptStatuses:e},d)).then((e=>{const{data:a,error:i}=e;if(i)n.handleLoadingError(i);else if(a&&Object.keys(a).length>0){const{currentPage:e,rootLevelPages:n}=a,i=(0,x.y4)(e,l);if((0,x.HM)(e)){const n=(0,x.EH)(e,d);return r(t,s,o,n,i)}return{mergedPages:i,rootLevelPages:n}}}))),[a,n,e]);return{loadAllPages:r}};var O=n(625764);const N=({statuses:e,isSuperAdmin:t})=>{const[n,a]=_(),i=(e=>{const{refetch:t}=(0,d.aM)(e,{fetchPolicy:"no-cache",skip:!0});return(0,s.useCallback)((e=>t(e)),[t])})(O.i),r=(0,s.useCallback)(((n,a,s={count:0,nodes:[]})=>i({contentId:n,statuses:e,first:M.P_,after:a,isSuperAdmin:t||!1}).then((e=>{if(e.data){const{children:t}=e.data.page,a=(0,x.XJ)(s,t);return t.pageInfo.hasNextPage?r(n,t.pageInfo.endCursor,a):a}}))),[i,t,e]),o=(0,s.useCallback)((()=>{r(n.focusedPageId)}),[r,n.focusedPageId]);return{queryChildren:r,reloadChildren:o}};var F=n(34642);const U=(e,t,n,a,s,r)=>{const o=e?k.w:L.c,d=e?{spaceKey:s,isSuperAdmin:r,statuses:F.Mx,ptStatuses:F.Mx,contentId:e}:{spaceKey:s,isSuperAdmin:r,statuses:F.Mx,emojiTitleEnabled:!0},l=(0,i.Z)({paginationLimit:M.Nx},d);return{query:o,options:{fetchPolicy:a?"no-cache":n?"network-only":"cache-first",variables:!0!==t&&e?d:l}}},$=(e,t,n,a,i,r)=>{const{query:o,options:l}=(0,s.useMemo)((()=>U(e,t,n,a,i,r)),[e,t,n,a,i,r]);return(0,d.aM)(o,{skip:!0,fetchPolicy:l.fetchPolicy})},j=(e,t,n)=>{if(void 0===n.index)return{pageId:t,parentId:n.parentId};const a=0===n.index,i=e.children.indexOf(t),s=i>-1&&i<n.index,r=a||s?n.index:n.index-1;return{pageId:t,siblingId:String(e.children[r]),positionToSibling:0===n.index?"before":"after"}},H=({onMoveInvalid:e,syntheticItem:t,onPageMove:n,queryChildren:a})=>{const[i,r]=_(),{pages:d,space:l}=i,g=(0,p.TW)("confluence.frontend.page-tree.pragmatic-dnd");return(0,s.useCallback)(((i,s)=>{var c,p;const u=((e,t,n,a)=>t&&!o()(e,t)&&n[t.parentId]?"DRAFT"===n[t.parentId].data.status?"INVALID_MOVE_LOCATION_DRAFT":!a&&Object.keys(n).length>=M.D2?"TREE_TOO_LARGE":null:"INVALID_MOVE_LOCATION")(i,s,d,g);if(null!==u)return void(e&&e({reason:u}));const h=(null==t?void 0:t.id)||d[i.parentId].children[i.index],m=(null===(c=d[h])||void 0===c||null===(p=c.data)||void 0===p?void 0:p.status)||null,f=d[s.parentId],v=d[i.parentId],I=h===(null==t?void 0:t.id);r.movePageInState(h,i,s,a,I,g);const P=j(f,h,s);n(P,{contentStatus:m,destination:s,movedPageTitle:d[h].data.title,source:i,sourceParent:v,spaceId:null==l?void 0:l.id,revertMove:()=>{const{pages:e}=r.getState(),t=e[v.id],n=t.children.length>0?i:{parentId:v.id};return r.movePageInState(h,s,n,!0,!0,g),j(t,h,n)}})}),[r,d,l,e,n,a,null==t?void 0:t.id,g])},K=()=>{},B="confluence.frontend.page-tree.pragmatic-dnd",Q=(0,s.memo)((({currentPageId:e,isPeekingFromBlogs:t,isSuperAdmin:n,spaceKey:a,statuses:r,expandSpaceHomepage:d=!1,onInitialLoadComplete:u=K,onLoadMore:h=K,onDragStart:m=K,onPageMove:f=K,setIsViewingSpaceHomepage:v=K,setHasItemsToDisplay:I=K,setIsPageTreeLoading:P=K,onMoveInvalid:S,renderItem:b,treeWrapperComponent:y,forceFetchCurrentPage:x=!1,forceFetchedCallback:T,highlightPages:C=[],isDraggable:Z,syntheticItem:w,detached:A=!1,syntheticItemIsDraft:k,isDraggingItem:L,setIsDraggingItem:O})=>{var F;const j=(0,s.useRef)({previousPageId:"",previousSpaceKey:"",previousHighlightedPages:[],previousForceFetchCurrentPage:!1,loadingUseEffect:!1}),[Q,q]=_(),{pages:V,space:W,rootId:G,isTreeTruncated:z,isPageTreeLoading:X,focusedPageId:J}=Q,Y=(Number((0,c.y)("confluence.ssr.page-tree.render-limit")),(0,p.TW)(B)),{loadMorePages:ee,reloadChildren:te,queryChildren:ne}=((e,t,n,a)=>{const[i,r]=_(),{focusedPageId:o}=i,{loadAllPages:d}=R({statuses:n}),{reloadChildren:l,queryChildren:g}=N({statuses:n,isSuperAdmin:t});return{loadMorePages:(0,s.useCallback)((async()=>{r.setIsPageTreeLoading(!0);const{mergedPages:n,rootLevelPages:s}=await d(o,e,t,i.cursors,i.initialPages),l=(0,E.oH)(n,s);r.setStateWithUIAttributes({pages:l}),r.setIsPageTreeLoading(!1),r.setIsTreeTruncated(!1),a&&a()}),[r,d,o,t,a,e,i.cursors,i.initialPages]),reloadChildren:l,queryChildren:g}})(a,n,r,h),{refetch:ae}=$("1",!0,!1,A,a,n),{refetch:ie}=$("1",!0,!0,A,a,n),{refetch:se}=$(void 0,!0,!0,A,a,n),re=((e,t,n,a=!1,i=!1,r,o)=>{const[d,l]=_(),{queryChildren:g}=N({statuses:r,isSuperAdmin:i});return(0,s.useCallback)((i=>{if(i&&Object.keys(i).length>0){var s,r;const c=null===(s=i.space)||void 0===s||null===(r=s.homepage)||void 0===r?void 0:r.id,p=(0,E.Tu)(i,e,d,a,n,o);l.setStateWithUIAttributes(p);const{rootId:u,pages:h}=p;return t&&c&&u!==c&&h[c]?l.expandPage(h[c],g):h}return i}),[e,d,a,n,o,l,t,g])})(a,d,w,t,n,r,k),oe=(0,s.useCallback)((async({data:e,error:t})=>t?(q.handleLoadingError(t),e):(q.setIsPageTreeLoading(!1),re(e),x&&T&&T(e),e)),[re,q,x,T]),de=(0,s.useCallback)((async e=>{var i,s;if(null!=e&&null!==(i=e.space)&&void 0!==i&&null!==(s=i.homepage)&&void 0!==s&&s.id){var r,o;const i=null==e||null===(r=e.space)||void 0===r||null===(o=r.homepage)||void 0===o?void 0:o.id;if(t&&i&&"noHomepageFound"!==i){const{options:e}=U(i,!0,!1,A,a,n);return ie(e.variables).then((e=>oe(e)))}}}),[A,ie,oe,t,n,a]),le=H({onMoveInvalid:S,syntheticItem:w,onPageMove:f,queryChildren:ne}),ge=(0,s.useCallback)((e=>{var t;const n=null==W||null===(t=W.homepage)||void 0===t?void 0:t.id;P(X),I(Object.keys(e).length>0),v(J===n)}),[P,X,I,v,J,null==W||null===(F=W.homepage)||void 0===F?void 0:F.id]);(0,s.useEffect)((()=>{const{previousPageId:i,previousSpaceKey:s,previousHighlightedPages:r,previousForceFetchCurrentPage:d}=j.current,{options:l}=U(e,!0,!1,A,a,n),g=e?ae:se;(!j.current.loadingUseEffect||x&&!d)&&(j.current.loadingUseEffect=!0,(async()=>{if(e&&(x||i!==e)){const t=V[e];if(x&&!0!==d)return ie(l.variables).then((e=>oe(e)));if(C.length&&!o()(r,C)){const e=V[C[0]];if(!e)return ie(l.variables).then((e=>oe(e)));if(e)return q.expandPage(e,ne)}else{if(!t||a!==s&&""!==s)return g(l.variables).then((e=>oe(e)));if(!window.__SSR_RENDERED__&&""===i)return ie(l.variables).then((async e=>oe(e)));if(i!==e&&t&&t.hasChildren)return q.expandPage(t,ne)}}if(!e&&a!==s)return g(l.variables).then((e=>t?de(e.data):oe(e)))})().then((e=>{if(e){const{pages:n}=(0,E.Tu)(e,a,Q,t,w,k);ge(n)}j.current.loadingUseEffect=!1}))),j.current.previousPageId=e,j.current.previousSpaceKey=a,j.current.previousHighlightedPages=C,j.current.previousForceFetchCurrentPage=x,Object.keys(V).length>=0&&q.updatePersistedState()}),[q,e,q.expandPage,x,ie,C,ae,se,V,a,T,ne,ge,A,oe,n,de,t,Q,w,k]);const ce=(0,s.useCallback)((async e=>{var t,n;if(!w)return;const a=null==w?void 0:w.id;if((null==e?void 0:e.id)===a)return;const i=Object.keys(V).find((e=>{var t,n,i,s;return(null===(t=V[e])||void 0===t||null===(n=t.data)||void 0===n?void 0:n.hasSyntheticChild)||(null===(i=V[e])||void 0===i||null===(s=i.children)||void 0===s?void 0:s.includes(a))}));if(!i)return;const s={parentId:i,index:null===(t=V[i])||void 0===t||null===(n=t.children)||void 0===n?void 0:n.indexOf(a)},r={parentId:e.id};-1!==s.index&&le(s,r)}),[V,w,le]),pe=(0,s.useCallback)((e=>{q.expandPage(e,ne)}),[q,ne]),ue=(0,s.useCallback)((e=>Z(e,{space:W})),[W,Z]),he=(0,s.useCallback)((e=>{var t;const n=null==W||null===(t=W.homepage)||void 0===t?void 0:t.id;return b((0,i.Z)((0,i.Z)({},e),{},{spaceHomePageId:n,onClick:ce,updateSinglePage:q.updateSinglePage}))}),[W,b,ce,q.updateSinglePage]),me=(0,s.useCallback)((()=>{m&&m(),Object.keys(V).length>M.D2&&(window.dispatchEvent(new Event("scroll")),!Y&&S&&S({reason:"TREE_TOO_LARGE"}))}),[m,V,S,Y]);return s.createElement(s.Fragment,null,s.createElement(D.x,{isDraggable:ue,isTreeTruncated:z,loadMorePages:ee,onCollapse:q.collapsePage,onDragStart:me,onDragEnd:le,onExpand:pe,onInitialLoadComplete:u,tree:{rootId:G,items:V},treeWrapperComponent:y,loading:X,refactor:!0,renderItem:he,isPragmaticDnDEnabled:Y,isDraggingItem:L,setIsDraggingItem:O}),s.createElement(l.h,{name:"pagetree",types:[g.ai.content],reload:te}),!1)})),q=e=>{let t=(0,a.Z)({},e);const{query:n,options:i}=U(t.currentPageId,!0,!1,!1,t.spaceKey,t.isSuperAdmin),{data:r}=(0,d.aM)(n,{variables:i.variables,fetchPolicy:"cache-only"});return s.createElement(A,{currentPageId:t.currentPageId,highlightPages:t.highlightPages,initialData:r,spaceKey:t.spaceKey,syntheticItem:t.syntheticItem,onExpand:t.onExpand,onLoadError:t.onLoadError,syntheticItemIsDraft:t.syntheticItemIsDraft,isPeekingFromBlogs:t.isPeekingFromBlogs,detached:t.detached},s.createElement(Q,{currentPageId:t.currentPageId,isPeekingFromBlogs:t.isPeekingFromBlogs,isSuperAdmin:t.isSuperAdmin,spaceKey:t.spaceKey,statuses:t.statuses,setHasItemsToDisplay:t.setHasItemsToDisplay,setIsPageTreeLoading:t.setIsPageTreeLoading,setIsViewingSpaceHomepage:t.setIsViewingSpaceHomepage,expandSpaceHomepage:t.expandSpaceHomepage,onInitialLoadComplete:t.onInitialLoadComplete,onLoadMore:t.onLoadMore,onDragStart:t.onDragStart,onPageMove:t.onPageMove,onMoveInvalid:t.onMoveInvalid,renderItem:t.renderItem,treeWrapperComponent:t.treeWrapperComponent,isDraggable:t.isDraggable,syntheticItem:t.syntheticItem,detached:t.detached,syntheticItemIsDraft:t.syntheticItemIsDraft,forceFetchCurrentPage:t.forceFetchCurrentPage,forceFetchedCallback:t.forceFetchedCallback,highlightPages:t.highlightPages,isDraggingItem:t.isDraggingItem,setIsDraggingItem:t.setIsDraggingItem,setOpenQuickActionsId:t.setOpenQuickActionsId}))};q.displayName="PageTreeCoordinator"},199767:(e,t,n)=>{"use strict";n.d(t,{n:()=>Z,N:()=>A});var a=n(991332),i=n(790632),s=n(122551),r=n(131436),o=n(685753),d=n(615139),l=n(288815),g=n(810602),c=n(917465),p=n(891322),u=n(803384),h=n(756850),m=n(117918),f=n(28201);const v=(0,f.ZR)({__loadable_id__:"dyBhk",name:"HomepageIcon",loader:async()=>(await n.e(61794).then(n.bind(n,903886))).HomepageIcon}),I=(0,f.ZR)({__loadable_id__:"49YQy",name:"DraftLozenge",loader:async()=>(await n.e(94184).then(n.bind(n,119388))).DraftLozenge});var P=n(44127);const S="medium",b=(0,s.memo)((0,i.Z)("div",{target:"e1a4ig9z0"})("width:24px;font-size:12pt;display:flex;align-items:center;justify-content:center;color:",(e=>e.itemIsRestricted?r.$H:"inherit"),";")),y=(0,s.memo)((0,i.Z)("div",{target:"e1a4ig9z1"})({name:"ux5l63",styles:"height:3px;line-height:0;"})),E=(0,i.Z)("span",{target:"e1a4ig9z2"})({name:"k008qs",styles:"display:flex;"}),x=(0,i.Z)("span",{target:"e1a4ig9z3"})({name:"xrz7ko",styles:"display:inline-block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;"}),T=(0,i.Z)("div",{target:"e1a4ig9z4"})({name:"5hz1ob",styles:"margin:0 4px;"}),C=(0,i.Z)("span",{target:"e1a4ig9z5"})({name:"v7y5hs",styles:"display:flex;flex-shrink:0;margin-right:6px;align-items:center;"}),Z=(0,s.memo)((({item:e,isSuperAdmin:t,onExpand:n,onCollapse:i})=>{const{isChildrenLoading:g,hasChildren:c,isExpanded:p,hasRestrictions:u,hasInheritedRestrictions:h}=e,m=!!t&&(u||h),f=m?r.$H:void 0,v=(0,a.Z)({display:"flex"},!1);return g?s.createElement(T,{"data-testid":"tree-item-spinner"},s.createElement(o.Z,{size:16})):c?p?s.createElement("div",{role:"button",tabIndex:0,onClick:i,"data-testid":"chevron-down",style:v},s.createElement(d.default,{primaryColor:f,label:"",size:S})):s.createElement("div",{role:"button",tabIndex:0,onClick:n,"data-testid":"chevron-right",style:v},s.createElement(l.default,{primaryColor:f,label:"",size:S})):s.createElement(b,{itemIsRestricted:m,"data-testid":"dot-icon"},s.createElement(y,null,"•"))})),w=(0,s.memo)((({displayHomePageIcon:e,displayEmoji:t,displayTitle:n,isDraft:a})=>s.createElement(E,null,e?s.createElement(v,null):null,t?s.createElement(g.gN,{key:t,emoji:t,context:"pageTree",height:14,parentComponent:"PageTreeItem",wrapper:C}):null,s.createElement(x,{className:"title"},n),a&&s.createElement(I,null)))),A=function({item:e,draftText:t="",spaceHomePageId:n,onExpand:i,onCollapse:r,onHighlight:o,snapshot:d,draggableState:l,isSuperAdmin:g,onClick:f,spaceKey:v,indent:I,dragHandleProps:S,isHoverPageCardOptedIn:b,hoverPageCardTriggerRef:y,closeAllHoverPageCards:E,isQuickActionsOpen:x,setOpenQuickActionsId:T,isQuickActionsFocused:C,setFocusedQuickActionsId:A,isEditingTitle:_,setIsEditingTitleId:D,isHoveringPageCard:k,onEnterHoverTarget:L,onLeaveHoverTarget:M,onBlurHoverTarget:R,isDraft:O,updateSinglePage:N,shouldRenderAfterIcon:F,contentStatus:U,isPragmaticDndEnabled:$}){var j,H,K,B,Q,q,V;const W=null==e||null===(j=e.data)||void 0===j?void 0:j.emoji,G=(null==e||null===(H=e.data)||void 0===H?void 0:H.title)||t,z=null==e||null===(K=e.data)||void 0===K?void 0:K.isHighlighted,X=null==e||null===(B=e.data)||void 0===B?void 0:B.isSelected,J=`${c.b}${null==e||null===(Q=e.data)||void 0===Q?void 0:Q.webui}`;return(0,s.useEffect)((()=>{z&&setTimeout(o,1e3*p.tO)}),[z,o]),s.createElement("div",(0,a.Z)((0,a.Z)({},S),{},{onMouseDown:()=>{E(),$&&x&&T(null)},onBlur:e=>R(e,A),ref:y}),s.createElement(m.r,{id:null==e?void 0:e.id,title:null==e||null===(q=e.data)||void 0===q?void 0:q.fullTitle,displayEmoji:null==e||null===(V=e.data)||void 0===V?void 0:V.emojiFromProperties,isEditingTitle:_,setIsEditingTitleId:D,setFocusedQuickActionsId:A,updateSinglePage:N,isDraft:O,contentStatus:U},s.createElement(h.p,{title:G,isHoverPageCardOptedIn:b,isQuickActionsOpen:x},s.createElement(P.JF,{dragHandleProps:S,onMouseEnter:()=>L(null==e?void 0:e.id.toString(),C),onFocus:()=>L(null==e?void 0:e.id.toString(),C),onMouseLeave:M,onBlur:R,isSelected:X,onClick:f,href:J,item:e,snapshot:d,draggableState:l,isSuperAdmin:g,indent:I,forceHoverBackground:x||k,isQuickActionsFocused:C,isPragmaticDndEnabled:$,beforeIcon:s.createElement(Z,{item:e,isSuperAdmin:g,onExpand:t=>{t.preventDefault(),t.stopPropagation(),i(null==e?void 0:e.id)},onCollapse:t=>{t.preventDefault(),t.stopPropagation(),r(null==e?void 0:e.id)}}),afterIcon:F&&s.createElement(u.$,{setFocusedQuickActionsId:A,isSuperAdmin:g,isQuickActionsOpen:x,setOpenQuickActionsId:T,setIsEditingTitleId:D,closeAllHoverPageCards:E,spaceKey:v,item:e})},s.createElement(w,{displayHomePageIcon:(null==e?void 0:e.id)===n,isDraft:O,displayTitle:G,displayEmoji:W})))))};A.displayName="PageTreeItem"},44127:(e,t,n)=>{"use strict";n.d(t,{Xx:()=>g,Uc:()=>c,rn:()=>p,JF:()=>P});var a=n(991332),i=n(790632),s=n(122551),r=n(336198),o=n(131436),d=n(612642),l=n(891322);const g="--hover-display-after-icon",c="--hover-opacity-after-icon",p="--hover-bg-color",u=r.F4`
from {
  background: ${o.BA};
}
to {
  background: none;
}
`,h=(0,i.Z)("span",{target:"e1wjl5rj0"})("margin-right:4px;display:flex;height:24px;width:24px;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center;flex-shrink:0;color:",o.Mx,";"),m=(0,i.Z)("span",{target:"e1wjl5rj1"})({name:"1j3a96u",styles:"display:flex;flex-shrink:0;margin-left:12px;"}),f=(0,i.Z)("div",{target:"e1wjl5rj2"})({name:"rxjc56",styles:"width:100%;display:flex;min-height:24px;-webkit-box-align:center;align-items:center;margin:0;padding:0;"}),v=(0,i.Z)("span",{target:"e1wjl5rj3"})({name:"1fz0h1q",styles:"-webkit-box-flex:1;flex-grow:1;text-align:left;overflow:hidden;outline:none;display:flex;flex-direction:column;line-height:1.22;"}),I=(0,i.Z)("a",{target:"e1wjl5rj4"})((({item:e,snapshot:t={},draggableState:n,isSuperAdmin:a,indent:i,forceHoverBackground:s,isQuickActionsFocused:r,isSelected:h,isPragmaticDndEnabled:m})=>{var f,v;const{hasRestrictions:I,hasInheritedRestrictions:P}=e,{isDragging:S,draggingOver:b,combineTargetFor:y}=t,E=null==e||null===(f=e.data)||void 0===f?void 0:f.isHighlighted,x={padding:`0 10px 0 ${8+i}px`,backgroundColor:h?o.gt:"transparent","&:visited, &:active, &:focus":{color:h?o.AX:o.Mx,textDecoration:"none"},"--display-after-icon":s||r?"flex":"none","--opacity-after-icon":s||r?"100%":"0%","&:hover, &:focus-within":{"--display-after-icon":`var(${g}, flex)`,"--opacity-after-icon":`var(${c}, 100%)`,backgroundColor:`var(${p}, ${o.gt})`},width:"100%",display:"flex",minHeight:24,WebkitBoxAlign:"center",alignItems:"center",fontSize:14,userSelect:"none",borderRadius:3,borderColor:"none",color:h?o.AX:o.Mx,height:40,boxSizing:"border-box",animation:"0s ease 0s 1 normal none running none",margin:"0px !important",textDecoration:"none","&[data-react-beautiful-dnd-drag-handle]":{cursor:"pointer"},"&:hover":{textDecoration:"none",color:h?o.AX:o.Mx},"&:active":{backgroundColor:o.BA,boxShadow:"none",border:"none"},"&:focus":{outline:"none",boxShadow:`${(0,d.Z)("color.border.focused","#388BFF")} 0px 0px 0px 2px inset`,backgroundColor:o.BA}};return"DRAFT"===(null==e||null===(v=e.data)||void 0===v?void 0:v.status)&&(x["& .title"]={opacity:"0.7"}),a&&(I||P)&&(x.color=o.$H),S&&(x["&:active"]={border:"none",boxShadow:`${o.VG} 1px 5px 11px 2px`,backgroundColor:o.gt},x.borderRadius=5,b||(x.color=o.Bn,x.borderColor=o.Bn)),m&&n&&"idle"!==n&&(x["&:active"]={border:"none",boxShadow:"none",backgroundColor:"transparent"},x["&:focus"]={outline:"none",boxShadow:"none",backgroundColor:"transparent"},"generate-preview"!==n&&(x.color=`${(0,d.Z)("color.text.disabled",o.n2)} !important`)),y&&(x.backgroundColor=o.gt),x.animation=E?`${u} ${l.tO}s linear`:"none",s&&(x.backgroundColor=o.gt),x})),P=({dragHandleProps:e,item:t,isSelected:n,onMouseEnter:i,onMouseLeave:r,onBlur:o,onFocus:d,onClick:l,href:g,snapshot:c,draggableState:p,isSuperAdmin:u,indent:P,forceHoverBackground:S,isQuickActionsFocused:b,isPragmaticDndEnabled:y,beforeIcon:E,afterIcon:x,children:T})=>s.createElement(I,(0,a.Z)((0,a.Z)({},e),{},{onMouseEnter:i,onFocus:d,onMouseLeave:r,onBlur:o,isSelected:n,onClick:l,href:g,item:t,snapshot:c,draggableState:p,"data-testid":"page-tree-item",isSuperAdmin:u,indent:P,forceHoverBackground:S,isQuickActionsFocused:b,isPragmaticDndEnabled:y,"aria-current":n?"page":void 0}),s.createElement(f,null,s.createElement(h,null,E),s.createElement(v,null,T),s.createElement(m,null,x)));P.displayName="PageTreeLinkItem"},590941:(e,t,n)=>{"use strict";n.d(t,{Ks:()=>i,BQ:()=>s,D6:()=>r,hw:()=>o,_Z:()=>d,aE:()=>l,ar:()=>g});var a=n(991332);const i=({source:e,contentStatus:t,pageId:n,previousParentPageId:i,newParentPageId:s,previousSpaceId:r,newSpaceId:o,referrer:d})=>({type:"sendTrackEvent",data:{action:"updated",source:e,containerType:"space",containerId:r,objectType:"page",objectId:n,actionSubject:"page",attributes:(0,a.Z)({contentStatus:null!=t?t:null,previousSpaceId:r,previousParentPageId:i,newSpaceId:o,newParentPageId:s},d?{referrer:d}:void 0)}}),s=()=>({type:"sendUIEvent",data:{action:"dragged",actionSubject:"pageTree",source:"viewPageScreen"}}),r=e=>({type:"sendUIEvent",data:{action:"dropped",actionSubject:"pageTree",source:"viewPageScreen",attributes:{isValidTarget:e}}}),o=()=>({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"pageTreeDragDropUndo",source:"viewPageScreen"}}),d=()=>({type:"sendUIEvent",data:{action:"pressed",actionSubject:"keyboardShortcut",actionSubjectId:"pageTreeDragDropUndo",source:"viewPageScreen"}}),l=(e,t,n,a,i,s)=>{const r={type:"sendUIEvent",data:{containerType:"space",containerId:t,objectType:"page",objectId:null!=i?i:"",action:e,actionSubject:"pageTree",source:n?"pageTreeDrawer":"containerNavigation",attributes:{navigationLayer:"container",spaceView:"TREE",contentStatus:null!=a?a:null}}};return s&&(r.data.attributes.navdexPointType=s),r},g=()=>({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"showAllButton",source:"containerNavigation"}})},802059:(e,t,n)=>{"use strict";n.d(t,{UQ:()=>d,s3:()=>l,nJ:()=>g,Ny:()=>c,Gv:()=>p,XJ:()=>u,HM:()=>h,pL:()=>m,y4:()=>f,EH:()=>v});var a=n(991332),i=n(514645),s=n(724260),r=n.n(s),o=n(587090);const d=e=>{var t;return null!=e&&null!==(t=e.nodes)&&void 0!==t&&t.length?e.nodes.filter((e=>"string"==typeof e||!1===e.blank)):[]},l=e=>e.map((e=>e.id)),g=(e,t,n)=>{if(!n||!e||!t)return o.q;const a=e[t];if(!a)return o.q;switch(t){case n:return n;case o.c:return o.c;default:return g(e,a.parentId,n)}},c=e=>!e.hasChildren||Boolean(e.children)&&e.children.length>0,p=(e,t)=>(0,i.ZP)(e,(n=>{for(const i in t){const s=e[i],r=t[i];if(s){const e=c(r)?r.children:s.children;n[i]=(0,a.Z)((0,a.Z)({},r),{},{parentId:s.parentId,children:e})}else n[i]=r}return n})),u=(e,t)=>({count:e.count+t.count,nodes:[...e.nodes,...t.nodes]}),h=e=>{if(!e)return!1;const{previousSiblings:t,followingSiblings:n,children:a,nearestAncestors:i}=e;return i.nodes.filter((e=>e.previousSiblings.pageInfo.hasNextPage||e.followingSiblings.pageInfo.hasNextPage)).length>0||t.pageInfo.hasNextPage||n.pageInfo.hasNextPage||a.pageInfo.hasNextPage},m=(e,t,n)=>{if(t[e]){const{parentId:a}=t[e];if(a)return n.add(a),m(a,t,n)}return n},f=(e,t)=>t?(0,i.ZP)(t,(t=>{const{previousSiblings:n,followingSiblings:a,nearestAncestors:i,children:s}=e,{previousSiblings:o,followingSiblings:d,nearestAncestors:l,children:g}=t;o.nodes=r()(o.nodes,n.nodes,"id"),d.nodes=r()(d.nodes,a.nodes,"id"),g.nodes=r()(g.nodes,s.nodes,"id");const c=r()(i.nodes,l.nodes,"id");return l.nodes.forEach((e=>{const t=c.filter((t=>t.id===e.id));if(t.length>0){const{previousSiblings:n,followingSiblings:a}=t[0];n.nodes=r()(e.previousSiblings.nodes,n.nodes,"id"),a.nodes=r()(e.followingSiblings.nodes,a.nodes,"id")}})),l.nodes=c,o.pageInfo.hasNextPage=o.pageInfo.hasNextPage&&n.pageInfo.hasNextPage,d.pageInfo.hasNextPage=d.pageInfo.hasNextPage&&a.pageInfo.hasNextPage,l.pageInfo.hasNextPage=l.pageInfo.hasNextPage&&i.pageInfo.hasNextPage,t})):e,v=(e,t)=>{if(!e)return t;const{previousSiblings:n,followingSiblings:a,nearestAncestors:i,children:s}=e,r={},{endCursor:o}=n.pageInfo;r.previousSiblingsCursor=o||t.previousSiblingsCursor;const{endCursor:d}=a.pageInfo;r.followingSiblingsCursor=d||t.followingSiblingsCursor;const{endCursor:l}=i.pageInfo;r.nearestAncestorsCursor=l||t.nearestAncestorsCursor;const{endCursor:g}=s.pageInfo;r.childrenCursor=g||t.childrenCursor;const c=i.nodes.filter((e=>e.previousSiblings.pageInfo.hasNextPage)),p=c.length>0?c[0].previousSiblings.pageInfo.endCursor:null;r.naPreviousSiblingsCursor=p||t.naPreviousSiblingsCursor;const u=i.nodes.filter((e=>e.followingSiblings.pageInfo.hasNextPage)),h=u.length>0?u[0].followingSiblings.pageInfo.endCursor:null;return r.naFollowingSiblingsCursor=h||t.naFollowingSiblingsCursor,r}},960284:(e,t,n)=>{"use strict";n.d(t,{sq:()=>c,G3:()=>u,oH:()=>h,xl:()=>m,IX:()=>v,Tu:()=>P});var a=n(991332),i=n(514645),s=n(490398),r=n.n(s),o=n(724507),d=n(923269),l=n(802059),g=n(587090);const c=e=>{var t;const{text:n,emoji:a,selectedEmoji:i}=(0,d.u2)(e.title,(0,o.xV)(e),(0,o.bm)(e),e.status);return{id:e.id,children:(0,l.UQ)(e.children),parentId:null,hasChildren:e.hasChildren,isExpanded:!1,isChildrenLoading:!1,hasRestrictions:e.hasRestrictions||!1,hasInheritedRestrictions:e.hasInheritedRestrictions||!1,data:{title:n,fullTitle:e.title,status:e.status,blank:e.blank,emoji:a,emojiFromProperties:i,webui:null===(t=e.links)||void 0===t?void 0:t.webui}}},p=(e,t={})=>{if(!e)return;const n=(0,l.UQ)(e.children),a=(0,l.UQ)(e.nearestAncestors),i=[...(0,l.UQ)(e.previousSiblings),...(0,l.UQ)(e.followingSiblings)];return t[e.id]=c(e),i.forEach((e=>p(e,t))),a.forEach((e=>p(e,t))),n.forEach((e=>p(e,t))),t},u=(e,t={},n=!0)=>{const a=(0,l.UQ)(e).map((e=>{const n=c(e);return t[e.id]=n,n}));return t[g.q]={id:g.q,children:(0,l.s3)(a),parentId:null,hasChildren:!0,isExpanded:!0,isChildrenLoading:!1,hasRestrictions:!1,hasInheritedRestrictions:!1,data:{title:"",status:"",blank:!1,webui:""}},t[g.c]={id:g.c,children:[],parentId:g.q,hasChildren:!0,isExpanded:!0,isChildrenLoading:!1,hasRestrictions:!1,hasInheritedRestrictions:!1,data:{title:"",status:"",blank:!1,webui:""}},n&&(t=f(t)),t},h=(e,t)=>{let n={};if(!e)return n;n=p(e,n)||{},n=u(t,n,!1);const a=(0,l.UQ)(e.nearestAncestors),i=(0,l.UQ)(e.children),s=[...[...(0,l.UQ)(e.previousSiblings)].reverse(),{id:e.id,children:i},...(0,l.UQ)(e.followingSiblings)];a.forEach(((e,t)=>{let i=[];if(0===t)i=s;else{const e=a[t-1];i=[...[...(0,l.UQ)(e.previousSiblings)].reverse(),e,...(0,l.UQ)(e.followingSiblings)]}n[e.id].children=(0,l.s3)(i)})),n[e.id].children=(0,l.s3)(i);let r=s;if(a.length){const e=a[a.length-1];r=[...[...(0,l.UQ)(e.previousSiblings)].reverse(),e,...(0,l.UQ)(e.followingSiblings)]}return n[g.c].children=(0,l.s3)(r),n=f(n),n},m=(e,t,n,a,s)=>(0,i.ZP)(e,(e=>{for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];r.isExpanded=n.has(i),r.isChildrenLoading=a.has(i),r.data.isSelected=r.id===t,r.data.isHighlighted=(null==s?void 0:s.includes(r.id))||!1}})),f=e=>(0,i.ZP)(e,(e=>{Object.keys(e).forEach((t=>{const n=e[t];n&&n.children&&n.children.length&&n.children.forEach((t=>{"string"!=typeof t||n.id===g.c&&e[t].parentId===g.q||(e[t].parentId=n.id)}))}))})),v=(e,t,n)=>{const a=(0,i.ZP)(e,(e=>{e[t].children=n})),s=I(a,n,t);return f(s)},I=(e,t,n)=>(0,i.ZP)(e,(e=>{t.forEach((t=>{if(e[t]&&e[t].parentId&&e[t].parentId!==n){const n=e[e[t].parentId];n.children=r()(n.children,t)}}))})),P=(e,t,n,i,s,r)=>{var o;const{currentPage:d,rootLevelPages:g,space:c}=e,p=((e,t)=>e?h(e,t):u(t))(d,g),m=(0,l.EH)(d,{});let f=(0,l.Gv)(n.pages,p);const v=null==c||null===(o=c.homepage)||void 0===o?void 0:o.id,I=(0,l.nJ)(f,null==d?void 0:d.id,v),P=i?c.homepage&&c.homepage.id||"noHomepageFound":void 0;f=((e,t,n,i)=>{if(t=(0,a.Z)({},t),e&&e.id){var s;t[e.id]||t[n].children.some((t=>t===e.id))||(t[n]=(0,a.Z)((0,a.Z)({},t[n]),{},{children:[e.id,...t[n].children]}));const r=(null===(s=t[e.id])||void 0===s?void 0:s.data)||{};t[e.id]=(0,a.Z)((0,a.Z)({},e),{},{data:i?(0,a.Z)((0,a.Z)({},r),e.data):(0,a.Z)((0,a.Z)({},e.data),r)})}return t})(s,f,I,r);return{rootId:I,pages:f,space:c,spaceKey:t,expandedPages:((e,t)=>{for(const n in e){const a=e[n];a.hasChildren&&(0,l.Ny)(a)&&t.add(a.id)}return t})(f,n.expandedPages),isTreeTruncated:(0,l.HM)(d),cursors:m,initialPages:d,blogPeekRoot:P}}},971151:(e,t,n)=>{"use strict";n.d(t,{a:()=>a});const a=(0,n(464984).defineMessages)({flagErrorTitle:{id:"page-tree.dragndrop.failed.title",defaultMessage:"Something went wrong"},flagErrorDescription:{id:"page-tree.dragndrop.failed.description",defaultMessage:"Refresh the page and try again. If this keeps happening, contact your space administrator."},flagErrorAction:{id:"page-tree.dragndrop.failed.action.visitsupport",defaultMessage:"Visit Atlassian Support"},flagMovePagePermissionErrorTitle:{id:"page-tree.dragndrop.permissions.error.title",defaultMessage:"This page can’t be moved"},flagMovePagePermissionErrorDescription:{id:"page-tree.dragndrop.permissions.error.decription",defaultMessage:"You don’t have the right permission to move this restricted page. Contact your space administrator to resolve this."},flagUndoTitle:{id:"page-tree.dragndrop.undo.title",defaultMessage:'Moved "{pageTitle}"'},flagUndoUntitled:{id:"page-tree.dragndrop.undo.untitled",defaultMessage:'Moved "Untitled"'},flagUndoAction:{id:"page-tree.dragndrop.undo.action",defaultMessage:"Undo"},flagLargePageTreeTitle:{id:"page-tree.dragndrop.lpt.title",defaultMessage:"Too many pages"},flagLargePageTreeDescription:{id:"page-tree.dragndrop.lpt.description",defaultMessage:"Drag and drop is not available within a list of 500 pages or more. Refresh and try again without expanding the page tree, or go to space settings to reorder."},flagLargePageTreeSettingsAction:{id:"page-tree.dragndrop.lpt.settings.action",defaultMessage:"Go to space settings"},flagLargePageTreeRefreshAction:{id:"page-tree.dragndrop.lpt.refresh.action",defaultMessage:"Refresh page"},flagInvalidMoveDraftTitle:{id:"page-tree.dragndrop.invalid-move-draft.title",defaultMessage:"You can't move a page here"},flagInvalidMoveDraftDescription:{id:"page-tree.dragndrop.invalid-move-draft.description",defaultMessage:"A page can’t be nested under a draft. Publish the draft to move a page here."},untitledDraftText:{id:"page-tree.untitled-draft",defaultMessage:"Untitled"}})},719742:(e,t,n)=>{"use strict";n.d(t,{Gg:()=>r,jG:()=>d,ZA:()=>o});var a=n(902195);const i=(0,n(464984).defineMessages)({noCreatePermissionsErrorTitle:{id:"page-tree.move-page-dialog.published-page.move-error.no-create-permissions-error.title",defaultMessage:"This page can’t be moved"},noCreatePermissionsErrorDescription:{id:"page-tree.move-page-dialog.published-page.move-error.no-create-permissions-error.description",defaultMessage:"Moving a page to another space requires that you have permission to create a page in this space."},permissionsErrorTitle:{id:"page-tree.move-page-dialog.published-page.move-error.permissions-error.title",defaultMessage:"This page can’t be moved"},permissionsErrorDescription:{id:"page-tree.move-page-dialog.published-page.move-error.permissions-error.description",defaultMessage:"Moving a page to another space requires permissions you don’t have."},parentChildLoopErrorTitle:{id:"page-tree.move-page-dialog.published-page.move-error.parent-child-loop.title",defaultMessage:"This page can’t be moved"},parentChildLoopErrorDescription:{id:"page-tree.move-page-dialog.published-page.move-error.parent-child-loop.description",defaultMessage:"Pages can't be moved underneath themselves or their children."},singleConflictingPageNameErrorTitle:{id:"page-tree.move-page-dialog.published-page.move-error.single-conflicting-page-name.title",defaultMessage:"A page with this name already exists"},singleConflictingPageNameErrorDescription:{id:"page-tree.move-page-dialog.published-page.move-error.single-conflicting-page-name.description",defaultMessage:"A page called {conflictingPageName} already exists in the {destinationSpace} space. Rename the page you are moving."},multipleConflictingPageNamesErrorTitle:{id:"page-tree.move-page-dialog.published-page.move-error.multiple-conflicting-page-name.title",defaultMessage:"Pages with the same names already exist"},multipleConflictingPageNamesErrorDescription:{id:"page-tree.move-page-dialog.published-page.move-error.multiple-conflicting-page-name.description",defaultMessage:"The following pages already exist in the {destinationSpace} space: {listOfConflictingPageNames}. Rename the pages you are moving."},restrictionsPermissionErrorTitle:{id:"page-tree.move-page-dialog.published-page.move-error.no-restrictions-permissions.title",defaultMessage:"This page can’t be moved"},restrictionsPermissionErrorDescription:{id:"page-tree.move-page-dialog.published-page.move-error.no-restrictions-permissions.description",defaultMessage:"This page has restricted visibility, and you don’t have permission to create a page with restrictions in the new space. Remove the restrictions before moving it."},destinationDoesNotExistErrorTitle:{id:"page-tree.move-page-dialog.published-page.move-error.destination-does-not-exist.title",defaultMessage:"Select a different destination"},destinationDoesNotExistErrorDescription:{id:"page-tree.move-page-dialog.published-page.move-error.destination-does-not-exist.description",defaultMessage:"Someone just moved or archived the parent page you selected. Select a different destination for this page."},sourceDoesNotExistErrorTitle:{id:"page-tree.move-page-dialog.published-page.move-error.source-does-not-exist.title",defaultMessage:"This page can no longer be moved"},sourceDoesNotExistErrorDescription:{id:"page-tree.move-page-dialog.published-page.move-error.source-does-not-exist.description",defaultMessage:"Someone just archived this page, and archived pages can’t be moved."},defaultErrorTitle:{id:"page-tree.move-page-dialog.published-page.move-error.default.title",defaultMessage:"We’re having issues moving this page"},defaultErrorDescription:{id:"page-tree.move-page-dialog.published-page.move-error.default.description",defaultMessage:"Refresh the page, and try moving again. If that doesn’t solve the issue, try again later."},currentlyUpdatedErrorTitle:{id:"page-tree.move-page-dialog.published-page.move-error.currently-updated.title",defaultMessage:"We couldn’t move your page"},currentlyUpdatedErrorDescription:{id:"page-tree.move-page-dialog.published-page.move-error.currently-updated.description",defaultMessage:"Updates are happening to this page or its children. Refresh the page and try again."}}),s=e=>(e=>e.includes("A page with the name(s)")&&e.includes("already exist(s) in the space"))(e)?(e=>{const t="A page with the name(s) ",n=" already exist(s) in the space ",a=e.substring(e.indexOf(t)+t.length,e.indexOf(n)).split(","),s=e.substring(e.indexOf(n)+n.length,e.indexOf(". You must rename the page title before moving it."));return 1===a.length?{title:i.singleConflictingPageNameErrorTitle,description:i.singleConflictingPageNameErrorDescription,props:{values:{conflictingPageName:a[0],destinationSpace:s}}}:{title:i.multipleConflictingPageNamesErrorTitle,description:i.multipleConflictingPageNamesErrorDescription,props:{values:{listOfConflictingPageNames:(r=a,2===r.length?r.join(" and "):r.length>2?`${r.slice(0,r.length-1).join(", ")}, and ${r[r.length-1]}`:r.join(", ")),destinationSpace:s}}};var r})(e):(e=>e.includes("creates a parent-child loop"))(e)?{title:i.parentChildLoopErrorTitle,description:i.parentChildLoopErrorDescription}:(e=>e.includes("You can not restrict pages in the destination space."))(e)?{title:i.restrictionsPermissionErrorTitle,description:i.restrictionsPermissionErrorDescription}:void 0,r=e=>{var t;const n=null==e||null===(t=e.graphQLErrors)||void 0===t?void 0:t[0],r=(0,a.e)(n),o=null==n?void 0:n.message;return"400"===r?s(o):"404"===r?(e=>(e=>e.includes("The target page provided does not exist.")||e.includes("The target page with ID = ")&&e.includes("is archived"))(e)?{title:i.destinationDoesNotExistErrorTitle,description:i.destinationDoesNotExistErrorDescription}:(e=>e.includes("The source page provided does not exist.")||e.includes("The source page with ID = ")&&e.includes("is archived"))(e)?{title:i.sourceDoesNotExistErrorTitle,description:i.sourceDoesNotExistErrorDescription}:void 0)(o):"500"===r?(e=>(e=>e.includes("Can not set page as its own parent."))(e)?{title:i.parentChildLoopErrorTitle,description:i.parentChildLoopErrorDescription}:(e=>e.includes("UnexpectedRollbackException"))(e)?{title:i.currentlyUpdatedErrorTitle,description:i.currentlyUpdatedErrorDescription}:void 0)(o):void 0},o=e=>{var t;return"403"===(0,a.e)(null==e||null===(t=e.graphQLErrors)||void 0===t?void 0:t[0])?{title:i.permissionsErrorTitle,description:i.permissionsErrorDescription}:{title:i.defaultErrorTitle,description:i.defaultErrorDescription}},d=()=>({title:i.noCreatePermissionsErrorTitle,description:i.noCreatePermissionsErrorDescription})},34642:(e,t,n)=>{"use strict";let a;n.d(t,{Mx:()=>i}),function(e){e.CURRENT="CURRENT",e.DRAFT="DRAFT"}(a||(a={}));const i=[a.CURRENT,a.DRAFT]},890441:(e,t,n)=>{"use strict";n.d(t,{Nx:()=>a,P_:()=>i,D2:()=>s});const a=500,i=100,s=500},625764:(e,t,n)=>{"use strict";n.d(t,{i:()=>s});var a=n(331377);const i=a.ZP`fragment PageInfoFragment on Page{id title status blank hasChildren hasRestrictions@include(if:$isSuperAdmin)hasInheritedRestrictions@include(if:$isSuperAdmin)links{webui}properties(keys:["emoji-title-published" "emoji-title-draft"]){nodes{id key value version{number}}}}`,s=a.ZP`query PageTreeChildrenQuery($contentId:ID!$statuses:[PTGraphQLPageStatus]$first:Int$after:String$isSuperAdmin:Boolean!){page(id:$contentId status:$statuses){...PageInfoFragment children(first:$first after:$after){count nodes{...PageInfoFragment}pageInfo{hasNextPage endCursor}}}}${i}`},577864:(e,t,n)=>{"use strict";n.d(t,{w:()=>r});var a=n(331377);const i=a.ZP`fragment PageListFragment on PaginatedPageList{count nodes{...PageInfoFragment}pageInfo{hasNextPage endCursor}}`,s=a.ZP`fragment PageInfoFragment on Page{id title status hasChildren blank hasRestrictions@include(if:$isSuperAdmin)hasInheritedRestrictions@include(if:$isSuperAdmin)links{webui}properties(keys:["emoji-title-published" "emoji-title-draft"]){nodes{id key value version{number}}}}`,r=a.ZP`query PageTreeQuery($spaceKey:String!$statuses:[GraphQLPageStatus]$ptStatuses:[PTGraphQLPageStatus]$contentId:ID!$paginationLimit:Int$nearestAncestorCursor:String$naPreviousSiblingsCursor:String$naFollowingSiblingsCursor:String$previousSiblingsCursor:String$followingSiblingsCursor:String$childrenCursor:String$isSuperAdmin:Boolean!){currentPage:page(id:$contentId spaceKey:$spaceKey pageTree:$paginationLimit status:$ptStatuses enablePaging:true){...PageInfoFragment nearestAncestors(after:$nearestAncestorCursor){count pageInfo{hasNextPage endCursor}nodes{...PageInfoFragment previousSiblings(after:$naPreviousSiblingsCursor){...PageListFragment}followingSiblings(after:$naFollowingSiblingsCursor){...PageListFragment}}}previousSiblings(after:$previousSiblingsCursor){...PageListFragment}followingSiblings(after:$followingSiblingsCursor){...PageListFragment}children(after:$childrenCursor){...PageListFragment}}rootLevelPages:pages(spaceKey:$spaceKey status:$statuses){nodes{...PageInfoFragment}}space(key:$spaceKey){id homepage{id}operations{operation targetType}}}${s}${i}`},612726:(e,t,n)=>{"use strict";n.d(t,{c:()=>a});const a=n(331377).ZP`query PageTreeRootLevelPages($spaceKey:String!$statuses:[GraphQLPageStatus]$emojiTitleEnabled:Boolean=false$isSuperAdmin:Boolean!$paginationLimit:Int){rootLevelPages:pages(spaceKey:$spaceKey status:$statuses limit:$paginationLimit){nodes{id hasChildren title status blank hasRestrictions@include(if:$isSuperAdmin)hasInheritedRestrictions@include(if:$isSuperAdmin)properties(keys:["emoji-title-published" "emoji-title-draft"])@include(if:$emojiTitleEnabled){nodes{id key value version{number}}}links{webui}}}space(key:$spaceKey){id homepage{id}operations{operation targetType}}}`},117918:(e,t,n)=>{"use strict";n.d(t,{r:()=>o});var a=n(991332),i=n(415911),s=n(122551),r=n(303674);const o=e=>{let{children:t,isEditingTitle:n}=e,o=(0,i.Z)(e,["children","isEditingTitle"]);return n?s.createElement(r.Fo,(0,a.Z)((0,a.Z)({},o),{},{isEditingTitle:n}),t):s.createElement(s.Fragment,null,t)};o.displayName="ConditionalInlineRename"},303674:(e,t,n)=>{"use strict";n.d(t,{e0:()=>i,Fo:()=>s});var a=n(28201);const i=(0,a.ui)({__loadable_id__:"oDYxo",name:"PageTreeQuickActions",loader:async()=>(await Promise.all([n.e(61769),n.e(31110)]).then(n.bind(n,942384))).PageTreeQuickActions}),s=(0,a.ui)({__loadable_id__:"l8oLh",name:"InlineRename",loader:async()=>(await Promise.all([n.e(61769),n.e(46003),n.e(11385),n.e(72787),n.e(29466)]).then(n.bind(n,182584))).InlineRename,loading:({children:e})=>e})},154697:(e,t,n)=>{"use strict";n.d(t,{p:()=>p});var a=n(991332),i=n(415911),s=n(122551),r=n(499082),o=n(331377);const d=o.ZP`mutation MovePageAfterMutation($pageId:ID!$siblingId:ID!){movePageAfter(input:{pageId:$pageId siblingId:$siblingId}){page{id}}}`,l=o.ZP`mutation MovePageAppendMutation($pageId:ID!$parentId:ID!){movePageAppend(input:{pageId:$pageId parentId:$parentId}){page{id}}}`,g=o.ZP`mutation MovePageBeforeMutation($pageId:ID!$siblingId:ID!){movePageBefore(input:{pageId:$pageId siblingId:$siblingId}){page{id}}}`,c=o.ZP`mutation MovePageTopLevelMutation($pageId:ID!$spaceKey:String!){movePageTopLevel(input:{pageId:$pageId targetSpaceKey:$spaceKey}){page{id}}}`,p=()=>{const[e]=(0,r.Db)(d),[t]=(0,r.Db)(g),[n]=(0,r.Db)(l),[o]=(0,r.Db)(c);return{movePage:(0,s.useCallback)((async s=>{const r=e=>t=>{let{data:n}=t,s=(0,i.Z)(t,["data"]);return(0,a.Z)((0,a.Z)({},s),{},{data:void 0===n?void 0:{mutationResult:e(n)}})};return"parentId"in s?n({variables:{pageId:s.pageId,parentId:s.parentId}}).then(r((e=>e.movePageAppend))):"spaceKey"in s?o({variables:{pageId:s.pageId,spaceKey:s.spaceKey}}).then(r((e=>e.movePageTopLevel))):"after"===s.positionToSibling?e({variables:{pageId:s.pageId,siblingId:s.siblingId}}).then(r((e=>e.movePageAfter))):t({variables:{pageId:s.pageId,siblingId:s.siblingId}}).then(r((e=>e.movePageBefore)))}),[e,n,t,o])}}},587090:(e,t,n)=>{"use strict";n.d(t,{q:()=>a,c:()=>i});const a="VIRTUAL_ROOT_ID",i="VIRTUAL_LOCAL_ROOT_ID"},590726:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});var a=n(602722);const i=e=>((0,a.t)(e),null)},602722:(e,t,n)=>{"use strict";n.d(t,{t:()=>s});var a=n(122551),i=n(90995);const s=e=>{const{contentId:t,registerReloader:n}=(0,a.useContext)(i.qC);(0,a.useEffect)((()=>{n(e)}),[t,e.reload,e.name])}},271128:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});let a="undefined"!=typeof window&&window.__SSR_FEATURE_FLAGS__||{};function i(e){return e in a?a[e]:null}},658350:(e,t,n)=>{"use strict";n.d(t,{d:()=>i});var a=n(472783);const i=(e,t,n)=>{const{tree:i,itemRemoved:s}=(0,a.cu)(e,t);return(0,a.d3)(i,n,s)}}}]);
//# sourceMappingURL=9943.EpdhDNPFbP.js.map